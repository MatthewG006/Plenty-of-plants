"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{233:(e,t,a)=>{a.d(t,{ir:()=>T,dy:()=>D,KK:()=>O,Rx:()=>Z,SS:()=>$,bc:()=>Y,Tn:()=>P});var s=a(5155),l=a(2115),n=a(3998),r=a(1834),i=a(5740),c=a(5299),o=a(1503),d=a(9347),m=a(5937),h=a(5322),x=a(1360),u=a(5239),f=a(5894),p=a(4269),j=a(991),N=a(9689),w=a(4901),g=a(9285),v=a(8053),b=a(926);let y=(0,b.createServerReference)("40ff5d7db5ce3e834a114b4fed95a7f4937090b6fd",b.callServer,void 0,b.findSourceMapURL,"plantChatAction"),C=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("textarea",{className:(0,p.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});C.displayName="Textarea";var k=a(2739),G=a(9034);let R=l.forwardRef((e,t)=>{let{className:a,children:l,...n}=e;return(0,s.jsxs)(G.bL,{ref:t,className:(0,p.cn)("relative overflow-hidden",a),...n,children:[(0,s.jsx)(G.LM,{className:"h-full w-full rounded-[inherit]",children:l}),(0,s.jsx)(A,{}),(0,s.jsx)(G.OK,{})]})});R.displayName=G.bL.displayName;let A=l.forwardRef((e,t)=>{let{className:a,orientation:l="vertical",...n}=e;return(0,s.jsx)(G.VM,{ref:t,orientation:l,className:(0,p.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...n,children:(0,s.jsx)(G.lr,{className:"relative flex-1 rounded-full bg-border"})})});A.displayName=G.VM.displayName;var M=a(6948);function S(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden rounded-lg",children:(0,s.jsx)("div",{className:"absolute -top-1/2 w-1/12 h-[200%] bg-white/30 animate-sheen"})})}function E(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:10}).map((e,t)=>(0,s.jsx)(i.A,{className:"absolute animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),color:"hsl(".concat(360*Math.random(),", 100%, 70%)"),width:"".concat(5+5*Math.random(),"px"),height:"".concat(5+5*Math.random(),"px")}},t))})}function L(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:7}).map((e,t)=>(0,s.jsx)(i.A,{className:"absolute text-red-500 animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),width:"".concat(8+8*Math.random(),"px"),height:"".concat(8+8*Math.random(),"px")}},t))})}function z(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:7}).map((e,t)=>(0,s.jsx)(i.A,{className:"absolute text-yellow-300 animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),width:"".concat(5+5*Math.random(),"px"),height:"".concat(5+5*Math.random(),"px")}},t))})}function $(e){let{plant:t,open:a,onOpenChange:i,userId:o}=e,[d,m]=(0,l.useState)([]),[h,x]=(0,l.useState)(""),[f,j]=(0,l.useState)(!1),w=(0,l.useRef)(null),{playSfx:v}=(0,N.n)();if((0,l.useEffect)(()=>{t&&m(t.conversationHistory||[])},[t]),(0,l.useEffect)(()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight)},[d]),!t)return null;let b=async()=>{if(!h.trim()||f)return;let e={role:"user",content:h},a=[...d,e];m(a),x(""),j(!0),v("tap");try{let{response:s}=await y({plantName:t.name,plantPersonality:t.personality,userMessage:h,history:d,form:t.form}),l={role:"model",content:s};m([...a,l]),await (0,g.xW)(o,t.id,e.content,l.content),v("chime")}catch(e){console.error("Chat error:",e),m(d)}finally{j(!1)}};return(0,s.jsx)(r.lG,{open:a,onOpenChange:i,children:(0,s.jsxs)(r.Cf,{className:"max-w-md flex flex-col h-[70vh]",children:[(0,s.jsxs)(r.c7,{children:[(0,s.jsxs)(r.L3,{className:"text-2xl text-center text-primary",children:["Chat with ",t.name]}),(0,s.jsxs)(r.rr,{className:"text-center",children:["Personality: ",(0,s.jsx)("span",{className:"font-semibold",children:t.personality})]})]}),(0,s.jsxs)("div",{ref:w,className:"flex-grow overflow-y-auto p-4 space-y-4 bg-muted/50 rounded-lg",children:[d.map((e,a)=>(0,s.jsxs)("div",{className:(0,p.cn)("flex items-end gap-2","user"===e.role?"justify-end":"justify-start"),children:["model"===e.role&&(0,s.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden border-2 border-primary/50 shrink-0",children:(0,s.jsx)(u.default,{src:t.image,alt:t.name,width:32,height:32})}),(0,s.jsx)("div",{className:(0,p.cn)("max-w-xs p-3 rounded-lg","user"===e.role?"bg-primary text-primary-foreground":"bg-background"),children:(0,s.jsx)("p",{className:"text-sm",children:e.content})})]},a)),f&&(0,s.jsxs)("div",{className:"flex items-end gap-2 justify-start",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden border-2 border-primary/50 shrink-0",children:(0,s.jsx)(u.default,{src:t.image,alt:t.name,width:32,height:32})}),(0,s.jsx)("div",{className:"bg-background p-3 rounded-lg",children:(0,s.jsx)(c.A,{className:"w-5 h-5 animate-spin text-primary"})})]})]}),(0,s.jsxs)(r.Es,{className:"pt-4 flex-row gap-2",children:[(0,s.jsx)(C,{value:h,onChange:e=>x(e.target.value),placeholder:"Say something...",className:"flex-grow resize-none",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())},disabled:f}),(0,s.jsx)(n.$,{onClick:b,disabled:!h.trim()||f,children:"Send"})]})]})})}function Z(e){let{plant:t,open:a,onOpenChange:s,onStartEvolution:l,onSwapRequest:n}=e;return null}function D(e){let{plant:t,open:a,onConfirm:l,onCancel:n,isEvolving:r}=e;return t?(0,s.jsx)(v.Lt,{open:a,onOpenChange:e=>!e&&n(),children:(0,s.jsxs)(v.EO,{children:[(0,s.jsxs)(v.wd,{children:[(0,s.jsx)(v.r7,{children:"Your plant is growing!"}),(0,s.jsxs)(v.$v,{children:[t.name," is ready for a new form! Would you like to evolve it?"]})]}),(0,s.jsxs)(v.ck,{children:[(0,s.jsx)(v.Zr,{onClick:n,disabled:r,children:"Later"}),(0,s.jsx)(v.Rx,{onClick:l,disabled:r,children:r?(0,s.jsx)(c.A,{className:"animate-spin"}):"Evolve"})]})]})}):null}function O(e){let{plantName:t,newForm:a,newImageUri:l,open:i,onConfirm:c}=e;return(0,s.jsx)(r.lG,{open:i,onOpenChange:e=>!e&&c(),children:(0,s.jsxs)(r.Cf,{className:"max-w-sm",children:[(0,s.jsx)(r.c7,{children:(0,s.jsx)(r.L3,{className:"text-3xl text-center",children:"Evolution Complete!"})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 py-4",children:[(0,s.jsx)("div",{className:"w-64 h-64 rounded-lg overflow-hidden border-4 border-primary/50 shadow-lg bg-green-100",children:(0,s.jsx)(u.default,{src:l,alt:"Evolved ".concat(t),width:256,height:256,className:"object-cover w-full h-full"})}),(0,s.jsxs)("h3",{className:"text-2xl font-semibold text-primary",children:[t," has evolved into its ",a," form!"]})]}),(0,s.jsx)(r.Es,{children:(0,s.jsx)(n.$,{onClick:c,className:"w-full text-lg",children:"Continue"})})]})})}function P(e){let{open:t,onOpenChange:a,collectionPlants:l,onSelectPlant:n}=e;return(0,s.jsx)(r.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(r.Cf,{className:"max-w-md",children:[(0,s.jsxs)(r.c7,{children:[(0,s.jsx)(r.L3,{className:"text-2xl text-center text-primary",children:"Swap Plant"}),(0,s.jsx)(r.rr,{className:"text-center",children:"Select a plant from your collection to place in the garden."})]}),(0,s.jsx)(R,{className:"h-96",children:(0,s.jsx)("div",{className:"p-4 grid grid-cols-3 gap-4",children:l.length>0?l.map(e=>(0,s.jsx)(M.Zp,{className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>n(e.id),children:(0,s.jsxs)(M.Wu,{className:"p-0",children:[(0,s.jsx)("div",{className:"aspect-square relative flex items-center justify-center bg-muted/30",children:"placeholder"!==e.image?(0,s.jsx)(u.default,{src:e.image,alt:e.name,fill:!0,sizes:"100px",className:"object-cover","data-ai-hint":e.hint}):(0,s.jsx)(o.A,{className:"w-1/2 h-1/2 text-muted-foreground/40"})}),(0,s.jsx)("div",{className:"p-2 text-center bg-white/50",children:(0,s.jsx)("p",{className:"text-xs font-semibold text-primary truncate",children:e.name})})]})},e.id)):(0,s.jsx)("p",{className:"col-span-3 text-center text-muted-foreground",children:"Your collection is empty."})})})]})})}function T(e){let{open:t,onOpenChange:a,allPlants:l,onSelectPlant:n}=e;return(0,s.jsx)(r.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(r.Cf,{className:"max-w-md",children:[(0,s.jsxs)(r.c7,{children:[(0,s.jsx)(r.L3,{className:"text-2xl text-center text-primary",children:"Choose Your Contestant"}),(0,s.jsx)(r.rr,{className:"text-center",children:"Select a plant to enter into the beauty contest."})]}),(0,s.jsx)(R,{className:"h-96",children:(0,s.jsx)("div",{className:"p-4 grid grid-cols-3 gap-4",children:l.length>0?l.map(e=>(0,s.jsx)(M.Zp,{className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>{n(e),a(!1)},children:(0,s.jsxs)(M.Wu,{className:"p-0",children:[(0,s.jsx)("div",{className:"aspect-square relative flex items-center justify-center bg-muted/30",children:"placeholder"!==e.image?(0,s.jsx)(u.default,{src:e.image,alt:e.name,fill:!0,sizes:"100px",className:"object-cover","data-ai-hint":e.hint}):(0,s.jsx)(o.A,{className:"w-1/2 h-1/2 text-muted-foreground/40"})}),(0,s.jsxs)("div",{className:"p-2 text-center bg-white/50",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-primary truncate",children:e.name}),(0,s.jsxs)("p",{className:"text-[10px] text-muted-foreground",children:["Lvl ",e.level]})]})]})},e.id)):(0,s.jsx)("p",{className:"col-span-3 text-center text-muted-foreground",children:"You have no plants to enter."})})})]})})}function Y(e){let{plant:t,open:a,onOpenChange:l,onStartEvolution:c,onOpenChat:p,userId:b}=e,{playSfx:y}=(0,N.n)(),{toast:C}=(0,f.dj)(),{gameData:G}=(0,w.A)();if(!t||!b||!G)return null;let R=t.level>=10&&"Base"===t.form||t.level>=25&&"Evolved"===t.form,A=t.level>=50,$=async()=>{G.glitterCount>0&&(await (0,g.vV)(b),await (0,g.Z8)(b,t.id,{hasGlitter:!0,hasSheen:!1,hasRainbowGlitter:!1,hasRedGlitter:!1}),await (0,k.Gz)(b),C({title:"Sparkles!",description:"".concat(t.name," is now sparkling.")}))},Z=async()=>{G.sheenCount>0&&(await (0,g.Zk)(b),await (0,g.Z8)(b,t.id,{hasGlitter:!1,hasSheen:!0,hasRainbowGlitter:!1,hasRedGlitter:!1}),await (0,k.oe)(b),C({title:"So Shiny!",description:"".concat(t.name," now has a beautiful sheen.")}))},D=async()=>{G.rainbowGlitterCount>0&&(await (0,g.F$)(b),await (0,g.Z8)(b,t.id,{hasGlitter:!1,hasSheen:!1,hasRainbowGlitter:!0,hasRedGlitter:!1}),C({title:"Rainbow Power!",description:"".concat(t.name," is sparkling with all the colors of the rainbow.")}))},O=async()=>{G.redGlitterCount>0&&(await (0,g.uM)(b),await (0,g.Z8)(b,t.id,{hasGlitter:!1,hasSheen:!1,hasRainbowGlitter:!1,hasRedGlitter:!0}),C({title:"Fiery!",description:"".concat(t.name," is now sparkling with red glitter.")}))},P=async()=>{if(G.plantChatTokens>0&&!t.chatEnabled)try{await (0,g.Gg)(b,t.id),y("success"),C({title:"Chat Unlocked!",description:"You can now talk to ".concat(t.name,"!")})}catch(e){C({variant:"destructive",title:"Error",description:e.message})}},T=async()=>{try{await (0,g.pv)(b,t.id),l(!1),C({title:"Plant Deleted",description:"".concat(t.name," has been removed from your collection.")})}catch(e){C({variant:"destructive",title:"Error",description:"Could not delete plant."})}};return(0,s.jsx)(r.lG,{open:a,onOpenChange:l,children:(0,s.jsxs)(r.Cf,{className:"max-w-sm",children:[(0,s.jsx)(r.c7,{children:(0,s.jsx)(r.L3,{className:"text-3xl text-center text-primary",children:t.name})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 pt-4",children:[(0,s.jsxs)("div",{className:"w-64 h-64 relative",children:[(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border-4 border-primary/50 shadow-lg bg-green-100 flex items-center justify-center h-full",children:t.image&&"placeholder"!==t.image?(0,s.jsx)(u.default,{src:t.image,alt:t.name,width:256,height:256,className:"object-cover w-full h-full","data-ai-hint":t.hint}):(0,s.jsx)(o.A,{className:"w-24 h-24 text-muted-foreground/50"})}),t.hasGlitter&&(0,s.jsx)(z,{}),t.hasRedGlitter&&(0,s.jsx)(L,{}),t.hasSheen&&(0,s.jsx)(S,{}),t.hasRainbowGlitter&&(0,s.jsx)(E,{})]}),(0,s.jsx)("p",{className:"text-muted-foreground text-center mt-2 px-4",children:t.description}),(0,s.jsxs)("div",{className:"w-full px-4 space-y-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-baseline",children:[(0,s.jsxs)("p",{className:"text-lg font-semibold text-primary",children:["Level ",t.level]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:A?"MAX":"".concat(t.xp," / ").concat(1e3," XP")})]}),(0,s.jsx)(j.k,{value:A?100:t.xp/1e3*100,className:"w-full"})]}),(0,s.jsx)("div",{className:"flex justify-between text-xs text-muted-foreground",children:(0,s.jsxs)("span",{children:["Form: ",(0,s.jsx)("span",{className:"font-semibold text-primary",children:t.form})]})})]})]}),(0,s.jsxs)(r.Es,{className:"pt-2 flex-col sm:flex-col sm:space-x-0 gap-2",children:[(0,s.jsx)(M.Zp,{children:(0,s.jsxs)(M.Wu,{className:"p-3 grid grid-cols-2 gap-2",children:[(0,s.jsxs)(n.$,{variant:"outline",size:"sm",onClick:$,disabled:G.glitterCount<=0||t.hasGlitter,children:[(0,s.jsx)(i.A,{})," Glitter (",G.glitterCount,")"]}),(0,s.jsxs)(n.$,{variant:"outline",size:"sm",onClick:Z,disabled:G.sheenCount<=0||t.hasSheen,children:[(0,s.jsx)(d.A,{})," Sheen (",G.sheenCount,")"]}),(0,s.jsxs)(n.$,{variant:"outline",size:"sm",onClick:D,disabled:G.rainbowGlitterCount<=0||t.hasRainbowGlitter,children:[(0,s.jsx)(i.A,{className:"text-pink-500"})," Rainbow (",G.rainbowGlitterCount,")"]}),(0,s.jsxs)(n.$,{variant:"outline",size:"sm",onClick:O,disabled:G.redGlitterCount<=0||t.hasRedGlitter,children:[(0,s.jsx)(i.A,{className:"text-red-500"})," Red (",G.redGlitterCount,")"]})]})}),R&&!A&&(0,s.jsxs)(n.$,{onClick:()=>{l(!1),c(t)},className:"w-full",children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"Evolve Plant"]}),A&&t.personality&&(t.chatEnabled?(0,s.jsxs)(n.$,{onClick:()=>p(t),className:"w-full",children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Chat with Plant"]}):(0,s.jsxs)(n.$,{onClick:P,className:"w-full",disabled:G.plantChatTokens<=0,children:[(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Unlock Chat (",G.plantChatTokens," token(s))"]})),(0,s.jsxs)(v.Lt,{children:[(0,s.jsx)(v.tv,{asChild:!0,children:(0,s.jsxs)(n.$,{variant:"destructive",className:"w-full",children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4"})," Delete Plant"]})}),(0,s.jsxs)(v.EO,{children:[(0,s.jsxs)(v.wd,{children:[(0,s.jsx)(v.r7,{children:"Are you absolutely sure?"}),(0,s.jsxs)(v.$v,{children:["This action cannot be undone. This will permanently delete ",t.name,"."]})]}),(0,s.jsxs)(v.ck,{children:[(0,s.jsx)(v.Zr,{children:"Cancel"}),(0,s.jsx)(v.Rx,{onClick:T,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,s.jsx)(r.HM,{asChild:!0,children:(0,s.jsx)(n.$,{className:"w-full",variant:"outline",children:"Close"})})]})]})})}},991:(e,t,a)=>{a.d(t,{k:()=>i});var s=a(5155),l=a(2115),n=a(9484),r=a(4269);let i=l.forwardRef((e,t)=>{let{className:a,value:l,...i}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,r.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...i,children:(0,s.jsx)(n.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});i.displayName=n.bL.displayName},8053:(e,t,a)=>{a.d(t,{$v:()=>p,EO:()=>h,Lt:()=>c,Rx:()=>j,Zr:()=>N,ck:()=>u,r7:()=>f,tv:()=>o,wd:()=>x});var s=a(5155),l=a(2115),n=a(2498),r=a(4269),i=a(3998);let c=n.bL,o=n.l9,d=n.ZL,m=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(n.hJ,{className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});m.displayName=n.hJ.displayName;let h=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(m,{}),(0,s.jsx)(n.UC,{ref:t,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});h.displayName=n.UC.displayName;let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};x.displayName="AlertDialogHeader";let u=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};u.displayName="AlertDialogFooter";let f=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(n.hE,{ref:t,className:(0,r.cn)("text-lg font-semibold",a),...l})});f.displayName=n.hE.displayName;let p=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...l})});p.displayName=n.VY.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(n.rc,{ref:t,className:(0,r.cn)((0,i.r)(),a),...l})});j.displayName=n.rc.displayName;let N=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(n.ZD,{ref:t,className:(0,r.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});N.displayName=n.ZD.displayName}}]);