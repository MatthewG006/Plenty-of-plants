"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[96],{3998:(e,t,a)=>{a.d(t,{$:()=>u,r:()=>d});var n=a(5155),s=a(2115),r=a(7129),l=a(3101),o=a(4269),i=a(9689);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:u=!1,onClick:c,disableSfx:h=!1,...m}=e,f=u?r.DX:"button",{playSfx:g}=(0,i.n)();return(0,n.jsx)(f,{className:(0,o.cn)(d({variant:s,size:l,className:a})),ref:t,onClick:e=>{h||g("tap"),c&&c(e)},...m})});u.displayName="Button"},4901:(e,t,a)=>{a.d(t,{A:()=>f,O:()=>m});var n=a(5155),s=a(2115),r=a(9253),l=a(4585),o=a(9708),i=a(5299),d=a(9285),u=a(3940),c=a(63);let h=(0,s.createContext)({user:null,gameData:null,loading:!0}),m=e=>{let{children:t}=e,[a,m]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),[p,x]=(0,s.useState)(!0),v=(0,c.useRouter)(),w=(0,c.usePathname)();return((0,s.useEffect)(()=>{let e,t=(0,r.hg)(l.j2,async t=>{if(m(t),t){let a=(0,o.H9)(l.db,"users",t.uid);e=(0,o.aQ)(a,e=>{if(e.exists()){var a;let t=e.data(),n=t.likedUsers||{};Array.isArray(t.likedUsers)&&(n=t.likedUsers.reduce((e,t)=>(e[t]=1,e),{})),g({gold:t.gold||0,plants:t.plants||{},collectionPlantIds:t.collectionPlantIds||[],deskPlantIds:t.deskPlantIds||Array(d.aw).fill(null),gardenPlantIds:t.gardenPlantIds||Array(d.Oh).fill(null),seeds:t.seeds||[],draws:null!=(a=t.draws)?a:u.RY,lastDrawRefill:t.lastDrawRefill||Date.now(),lastFreeDrawClaimed:t.lastFreeDrawClaimed||0,lastLoginBonusClaimed:t.lastLoginBonusClaimed||0,sprinklerUnlocked:t.sprinklerUnlocked||!1,glitterCount:t.glitterCount||0,sheenCount:t.sheenCount||0,rainbowGlitterCount:t.rainbowGlitterCount||0,redGlitterCount:t.redGlitterCount||0,fertilizerCount:t.fertilizerCount||0,showcasePlantIds:t.showcasePlantIds||[],challenges:t.challenges||{},challengesStartDate:t.challengesStartDate||0,likes:t.likes||0,likedUsers:n,autoWaterUnlocked:t.autoWaterUnlocked||!1,autoWaterEnabled:t.autoWaterEnabled||!1,waterRefillCount:t.waterRefillCount||0,rubyCount:t.rubyCount||0,plantChatTokens:t.plantChatTokens||0})}else(0,d.Jt)(t).then(g);x(!1)},e=>{console.error("Firestore snapshot error:",e),g(null),x(!1)})}else g(null),x(!1)});return()=>{t(),e&&e()}},[]),(0,s.useEffect)(()=>{if(p)return;let e=["/login","/signup"].includes(w),t="/"===w;a||e||t?a&&e&&v.push("/home"):v.push("/login")},[a,p,w,v]),p&&"/"!==w)?(0,n.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,n.jsx)(i.A,{className:"h-12 w-12 animate-spin text-primary"})}):(0,n.jsx)(h.Provider,{value:{user:a,gameData:f,loading:p},children:t})},f=()=>{let e=(0,s.useContext)(h);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5626:(e,t,a)=>{a.d(t,{A:()=>n});let n=(0,a(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5894:(e,t,a)=>{a.d(t,{dj:()=>c});var n=a(2115);let s=0,r=new Map,l=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},o=[],i={toasts:[]};function d(e){i=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(i,e),o.forEach(e=>{e(i)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||n()}}}),{id:a,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function c(){let[e,t]=n.useState(i);return n.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},6613:(e,t,a)=>{a.d(t,{A:()=>n});let n=(0,a(1847).A)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},8096:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var n=a(5155),s=a(3998),r=a(2619),l=a.n(r),o=a(5626),i=a(6613),d=a(5299);let u=(0,a(1847).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var c=a(4901),h=a(2115),m=a(8138),f=a(5239),g=a(9689),p=a(5894);function x(){let{gameData:e}=(0,c.A)(),{playSfx:t}=(0,g.n)(),{toast:a}=(0,p.dj)(),[r,x]=(0,h.useState)(null),[v,w]=(0,h.useState)(null),[b,y]=(0,h.useState)(!0);return(0,h.useEffect)(()=>{!async function(){if(null==e?void 0:e.plants){let t=Object.values(e.plants);if(t.length>0){let e=t[0];x(e);try{let t=await (0,m.x)(e.image);w(t)}catch(t){console.error("Failed to process image for park display:",t),w(e.image)}}}y(!1)}()},[e]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"min-h-screen bg-cover bg-center flex flex-col items-center justify-between text-white p-4 relative",style:{backgroundImage:"url('/park.png')"},children:[(0,n.jsx)("div",{className:"absolute top-4 left-4 z-10",children:(0,n.jsx)(s.$,{asChild:!0,variant:"secondary",children:(0,n.jsxs)(l(),{href:"/community",children:[(0,n.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Back to Showcase"]})})}),(0,n.jsx)("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center gap-4 mt-16",children:(0,n.jsxs)("div",{className:"bg-black/50 p-6 rounded-lg text-center shadow-lg backdrop-blur-sm z-0",children:[(0,n.jsxs)("h1",{className:"text-4xl font-bold mb-2",children:["Welcome to",(0,n.jsx)("br",{}),"the Park"]}),(0,n.jsx)("p",{className:"text-lg mb-4",children:"A quiet place to relax... or compete!"}),(0,n.jsx)(s.$,{asChild:!0,children:(0,n.jsxs)(l(),{href:"/community/contest",children:[(0,n.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"Enter Plant Beauty Contest"]})})]})}),(0,n.jsx)("div",{className:"w-full h-1/3 absolute bottom-0 left-0 flex items-end justify-start p-4 pointer-events-none",children:b?(0,n.jsx)(d.A,{className:"w-8 h-8 animate-spin text-white"}):v?(0,n.jsxs)("div",{className:"relative w-48 h-48 animate-fade-in-up",children:[(0,n.jsx)("div",{className:"absolute -top-8 left-1/2 -translate-x-1/4 w-24 h-12 bg-white rounded-full flex items-center justify-center cursor-pointer pointer-events-auto shadow-lg animate-pulse-subtle",onClick:()=>{t("tap"),a({title:"A Quiet Moment",description:"".concat((null==r?void 0:r.name)||"Your plant"," seems to be enjoying the peacefulness of the park.")})},children:(0,n.jsx)(u,{className:"w-8 h-8 text-black"})}),(0,n.jsx)(f.default,{src:v,alt:(null==r?void 0:r.name)||"A plant",fill:!0,className:"object-contain","data-ai-hint":null==r?void 0:r.hint})]}):null})]})})}},8138:(e,t,a)=>{async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;return new Promise((a,n)=>{let s=new window.Image;s.crossOrigin="anonymous",s.onload=()=>{let e=document.createElement("canvas"),{width:r,height:l}=s;r>l?r>t&&(l=Math.round(l*t/r),r=t):l>t&&(r=Math.round(r*t/l),l=t),e.width=r,e.height=l;let o=e.getContext("2d");if(!o)return n(Error("Could not get canvas context"));o.drawImage(s,0,0,r,l),a(e.toDataURL("image/jpeg",.8))},s.onerror=n,s.src=e})}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240;return new Promise((a,n)=>{let s=new window.Image;s.crossOrigin="anonymous",s.onload=()=>{let e=document.createElement("canvas"),{width:r,height:l}=s;e.width=r,e.height=l;let o=e.getContext("2d");if(!o)return n(Error("Could not get canvas context"));o.drawImage(s,0,0);let i=o.getImageData(0,0,r,l),d=i.data;for(let e=0;e<d.length;e+=4){let a=d[e],n=d[e+1],s=d[e+2];a>t&&n>t&&s>t&&(d[e+3]=0)}o.putImageData(i,0,0),a(e.toDataURL("image/png"))},s.onerror=t=>{console.warn("CORS or other error making background transparent, returning original image",t),a(e)},s.src=e})}a.d(t,{w:()=>n,x:()=>s})}}]);