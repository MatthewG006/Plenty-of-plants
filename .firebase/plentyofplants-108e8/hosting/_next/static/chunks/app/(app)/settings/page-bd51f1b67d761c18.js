(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{3116:(e,t,s)=>{Promise.resolve().then(s.bind(s,5356))},4901:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,O:()=>u});var r=s(5155),a=s(2115),n=s(9253),i=s(4585),l=s(9708),o=s(9285);let c=(0,a.createContext)({user:null,gameData:null,loading:!0}),u=e=>{let{children:t}=e,[s,u]=(0,a.useState)(null),[d,f]=(0,a.useState)(null),[m,p]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,n.hg)(i.j,async e=>{u(e),e||(f(null),p(!1))});return()=>e()},[]),(0,a.useEffect)(()=>{if(s){let e=(0,l.H9)(i.db,"users",s.uid),t=(0,l.aQ)(e,e=>{e.exists()?f(e.data()):(0,o.Jt)(s).then(e=>{f(e)}),p(!1)},e=>{console.error("Firestore subscription error:",e),f(null),p(!1)});return()=>t()}},[s]),(0,r.jsx)(c.Provider,{value:{user:s,gameData:d,loading:m},children:t})},d=()=>(0,a.useContext)(c)},5356:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(5155),a=s(6948),n=s(6444),i=s(2115),l=s(7599),o=s(4269);let c=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.bL,{className:(0,o.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:(0,r.jsx)(l.zi,{className:(0,o.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});c.displayName=l.bL.displayName;var u=s(3026);let d=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsxs)(u.bL,{ref:t,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",s),...a,children:[(0,r.jsx)(u.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,r.jsx)(u.Q6,{className:"absolute h-full bg-primary"})}),(0,r.jsx)(u.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});d.displayName=u.bL.displayName;var f=s(5299),m=s(3586),p=s(6154),h=s(5998),x=s(5894),g=s(63),b=s(9689),v=s(4901);function w(e){let{icon:t,label:s,children:a}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(t,{className:"h-6 w-6 text-primary"}),(0,r.jsx)(n.J,{htmlFor:s.toLowerCase(),className:"text-lg font-semibold text-primary",children:s})]}),a]})}function N(){let{user:e,gameData:t}=(0,v.A)();(0,g.useRouter)();let{toast:s}=(0,x.dj)(),{sfxVolume:n,setSfxVolume:l,playSfx:o,musicVolume:u,setMusicVolume:N,isMusicPlaying:j,toggleMusic:y}=(0,b.n)(),[S,A]=(0,i.useState)(!1),[C,k]=(0,i.useState)(!1);(0,i.useEffect)(()=>{A(!0),"Notification"in window&&k("granted"===Notification.permission)},[]);let T=async e=>{if(!("Notification"in window)||!("serviceWorker"in navigator))return void s({variant:"destructive",title:"Unsupported Browser",description:"Your browser does not support push notifications."});e?"granted"===await Notification.requestPermission()?(k(!0),navigator.serviceWorker.ready.then(e=>{var t;null==(t=e.active)||t.postMessage("schedule-notifications")}),s({title:"Notifications Enabled",description:"You will be reminded to play every 6 hours."})):s({variant:"destructive",title:"Permissions Denied",description:"You need to grant permission to enable notifications."}):(k(!1),navigator.serviceWorker.ready.then(e=>{var t;null==(t=e.active)||t.postMessage("cancel-notifications")}),s({title:"Notifications Disabled",description:"You will no longer receive reminders."}))};return S&&e&&t?(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("header",{className:"pb-4",children:(0,r.jsx)("h1",{className:"text-3xl text-primary text-center",children:"Settings"})}),(0,r.jsxs)(a.Zp,{children:[(0,r.jsx)(a.aR,{children:(0,r.jsx)(a.ZB,{children:"Game Controls"})}),(0,r.jsxs)(a.Wu,{children:[(0,r.jsx)(w,{icon:m.A,label:"Music",children:(0,r.jsx)(c,{id:"music",checked:j,onCheckedChange:y})}),(0,r.jsx)(w,{icon:p.A,label:"Effects",children:(0,r.jsx)(c,{id:"fx",checked:n>0,onCheckedChange:e=>l(.75*!!e)})}),(0,r.jsx)(w,{icon:h.A,label:"Reminders",children:(0,r.jsx)(c,{id:"reminders",checked:C,onCheckedChange:T,"aria-label":"Toggle notifications"})})]})]}),(0,r.jsxs)(a.Zp,{className:"mt-6",children:[(0,r.jsx)(a.aR,{children:(0,r.jsx)(a.ZB,{children:"Volume"})}),(0,r.jsxs)(a.Wu,{children:[(0,r.jsx)(w,{icon:m.A,label:"Music",children:(0,r.jsx)(d,{value:[100*u],onValueChange:e=>N(e[0]/100),max:100,step:1,className:"w-1/2","aria-label":"Music volume"})}),(0,r.jsx)(w,{icon:p.A,label:"Effects",children:(0,r.jsx)(d,{value:[100*n],onValueChange:e=>l(e[0]/100),onValueCommit:()=>o("tap"),max:100,step:1,className:"w-1/2","aria-label":"Effects volume"})})]})]})]}):(0,r.jsx)("div",{className:"flex h-screen w-full items-center justify-center",children:(0,r.jsx)(f.A,{className:"h-8 w-8 animate-spin text-primary"})})}},5894:(e,t,s)=>{"use strict";s.d(t,{dj:()=>d});var r=s(2115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=[],o={toasts:[]};function c(e){o=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(o,e),l.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function d(){let[e,t]=r.useState(o);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},6444:(e,t,s)=>{"use strict";s.d(t,{J:()=>c});var r=s(5155),a=s(2115),n=s(489),i=s(3101),l=s(4269);let o=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.b,{ref:t,className:(0,l.cn)(o(),s),...a})});c.displayName=n.b.displayName},6948:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>u,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>d});var r=s(5155),a=s(2115),n=s(4269);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});u.displayName="CardContent";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});d.displayName="CardFooter"},9689:(e,t,s)=>{"use strict";s.d(t,{G:()=>i,n:()=>l});var r=s(5155),a=s(2115);let n=(0,a.createContext)(void 0),i=e=>{let{children:t}=e,[s,i]=(0,a.useState)(()=>{{let e=localStorage.getItem("sfxVolume");return null!==e?parseFloat(e):.75}}),[l,o]=(0,a.useState)(()=>{{let e=localStorage.getItem("musicVolume");return null!==e?parseFloat(e):.2}}),[c,u]=(0,a.useState)(!1),d=(0,a.useRef)(null),f={tap:(0,a.useRef)(null),success:(0,a.useRef)(null),reward:(0,a.useRef)(null),chime:(0,a.useRef)(null),watering:(0,a.useRef)(null)};(0,a.useEffect)(()=>{d.current=new Audio("/music.mp3"),d.current.loop=!0,f.tap.current=new Audio("/sfx/tap.mp3"),f.success.current=new Audio("/sfx/success.mp3"),f.reward.current=new Audio("/sfx/reward.mp3"),f.chime.current=new Audio("/sfx/chime.mp3"),f.watering.current=new Audio("/sfx/watering.mp3")},[]),(0,a.useEffect)(()=>{d.current&&(d.current.volume=l),localStorage.setItem("musicVolume",String(l))},[l]);let m=(0,a.useCallback)(()=>{d.current&&d.current.paused&&d.current.play().then(()=>{u(!0)}).catch(e=>console.error("Music play failed on start:",e))},[]),p=(0,a.useCallback)(()=>{d.current&&(c?d.current.pause():d.current.play().catch(e=>console.error("Music play failed on toggle:",e)),u(!c))},[c]),h=(0,a.useCallback)(e=>{let t=f[e].current;t&&(t.volume=s,t.currentTime=0,t.play().catch(e=>console.error("SFX play failed",e)))},[s,f]);return(0,r.jsx)(n.Provider,{value:{sfxVolume:s,setSfxVolume:e=>{i(e),localStorage.setItem("sfxVolume",String(e))},musicVolume:l,setMusicVolume:e=>{o(e)},isMusicPlaying:c,toggleMusic:p,startMusic:m,playSfx:h},children:t})},l=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAudio must be used within an AudioProvider");return e}}},e=>{e.O(0,[992,416,909,382,26,560,441,255,358],()=>e(e.s=3116)),_N_E=e.O()}]);