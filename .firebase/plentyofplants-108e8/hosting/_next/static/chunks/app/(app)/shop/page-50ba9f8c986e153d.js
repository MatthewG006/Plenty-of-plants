(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[940],{4939:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>G});var l=t(5155),a=t(3998),r=t(6948),i=t(5894),c=t(3940),n=t(890),o=t(5299),d=t(8055),x=t(5322),h=t(709),u=t(6983),m=t(512),p=t(5937),f=t(6617),j=t(1503),w=t(968),N=t(9559),g=t(5740),v=t(9347),y=t(2115),b=t(9689),k=t(6259),C=t(4901),B=t(9285),E=t(1834);function Y(){let e=new Date,s=new Date(e);s.setDate(s.getDate()+1),s.setHours(0,0,0,0);let t=s.getTime()-e.getTime(),l=Math.floor(t/36e5),a=Math.floor(t%36e5/6e4);return"".concat(l,"h ").concat(a,"m")}function R(e){let{open:s,onOpenChange:t,onSkip:r,countdown:i}=e;return(0,l.jsx)(E.lG,{open:s,onOpenChange:t,children:(0,l.jsxs)(E.Cf,{className:"max-w-md p-0",hideCloseButton:!0,children:[(0,l.jsx)(E.c7,{children:(0,l.jsx)(E.L3,{className:"sr-only",children:"Video Ad"})}),(0,l.jsxs)("div",{className:"aspect-video bg-black flex flex-col items-center justify-center text-white relative",children:[(0,l.jsx)(n.A,{className:"w-16 h-16 text-muted-foreground"}),(0,l.jsx)("p",{className:"text-lg font-semibold mt-4",children:"Video Ad Placeholder"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your ad would be shown here."}),(0,l.jsx)("div",{className:"absolute bottom-4 right-4",children:i>0?(0,l.jsxs)("p",{className:"text-sm bg-black/50 rounded-full px-3 py-1",children:["Reward in ",i,"..."]}):(0,l.jsx)(a.$,{onClick:r,variant:"secondary",size:"sm",children:"Skip"})})]})]})})}function G(){let{user:e,gameData:s}=(0,C.A)(),{toast:t}=(0,i.dj)(),{playSfx:n}=(0,b.n)(),[E,G]=(0,y.useState)(!1),[A,S]=(0,y.useState)(Y()),[P,Z]=(0,y.useState)(!1),[F,T]=(0,y.useState)(5),$=(0,y.useRef)(null);(0,y.useEffect)(()=>{(async()=>{e&&G(await (0,c.h$)(e.uid))})();let s=setInterval(()=>{S(Y())},6e4);return()=>clearInterval(s)},[e]);let D=(0,y.useCallback)(async()=>{if(!e)return;let s=await (0,c.$k)(e.uid);s.success?(n("reward"),t({title:"Free Draw Claimed!",description:"Come back tomorrow for another one."}),G(!0)):t({variant:"destructive",title:"max_draws"===s.reason?"Max Draws Reached":"Already Claimed",description:"max_draws"===s.reason?"You already have the maximum number of draws.":"You can claim your next free draw tomorrow."})},[e,n,t]),W=(0,y.useCallback)(()=>{$.current&&clearInterval($.current),Z(!1),D()},[D]);(0,y.useEffect)(()=>(P?(T(5),$.current=setInterval(()=>{T(e=>e<=1?($.current&&clearInterval($.current),0):e-1)},1e3)):$.current&&clearInterval($.current),()=>{$.current&&clearInterval($.current)}),[P]);let _=async()=>{if(e&&s){if(s.gold<15)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(15," gold.")});try{await (0,B.FQ)(e.uid,15),n("reward"),t({title:"Purchase Successful!",description:"You bought 1 Water Refill."})}catch(e){console.error("Failed to purchase water refill",e),t({variant:"destructive",title:"Error",description:e.message||"Could not complete the purchase."})}}},M=async()=>{if(e&&s){if(s.gold<50)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(50," gold.")});try{await (0,B.JS)(e.uid,"glitterCount",1,50),n("reward"),t({title:"Purchase Successful!",description:"You bought 1 Glitter Pack!"})}catch(e){console.error("Failed to purchase glitter",e),t({variant:"destructive",title:"Error",description:"Could not complete the purchase."})}}},I=async()=>{if(e&&s){if(s.gold<100)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(100," gold.")});try{await (0,B.eL)(e.uid,100),n("reward"),t({title:"Purchase Successful!",description:"You bought the Sprinkler! Find it in your room."})}catch(e){console.error("Failed to purchase sprinkler",e),t({variant:"destructive",title:"Error",description:e.message||"Could not complete the purchase."})}}},O=async()=>{if(e&&s){if(s.gold<50)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(50," gold.")});try{await (0,B.JS)(e.uid,"sheenCount",1,50),n("reward"),t({title:"Purchase Successful!",description:"You bought 1 Sheen Pack!"})}catch(e){console.error("Failed to purchase sheen",e),t({variant:"destructive",title:"Error",description:"Could not complete the purchase."})}}},U=async()=>{if(e&&s){if(s.gold<60)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(60," gold.")});try{await (0,B.JS)(e.uid,"rainbowGlitterCount",1,60),n("reward"),t({title:"Purchase Successful!",description:"You bought 1 Rainbow Glitter Pack!"})}catch(e){console.error("Failed to purchase rainbow glitter",e),t({variant:"destructive",title:"Error",description:"Could not complete the purchase."})}}},z=async()=>{if(e&&s){if(s.gold<50)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(50," gold.")});try{await (0,B.JS)(e.uid,"redGlitterCount",1,50),n("reward"),t({title:"Purchase Successful!",description:"You bought 1 Red Glitter Pack!"})}catch(e){console.error("Failed to purchase red glitter",e),t({variant:"destructive",title:"Error",description:"Could not complete the purchase."})}}},J=async()=>{if(e&&s){if(s.gold<50)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(50," gold to buy a draw.")});if(s.draws>=c.RY)return void t({variant:"destructive",title:"Max Draws Reached",description:"You cannot buy more draws."});try{let s=await (0,c.$k)(e.uid,{bypassTimeCheck:!0,cost:50});s.success?(n("reward"),t({title:"Purchase Successful!",description:"You bought 1 draw for ".concat(50," gold.")})):"not_enough_gold"===s.reason?t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(50," gold to buy a draw.")}):t({variant:"destructive",title:"Purchase Failed",description:"Something went wrong. Your gold was not spent."})}catch(e){console.error("Failed to process gold transaction",e),t({variant:"destructive",title:"Error",description:"Could not complete the purchase."})}}},L=async()=>{if(e&&s){if(s.gold<215)return void t({variant:"destructive",title:"Not Enough Gold",description:"You need ".concat(215," gold.")});try{await (0,B.k_)(e.uid,215),n("reward"),t({title:"Bundle Purchased!",description:"You received all items from the Sparkle Bundle."})}catch(e){console.error("Failed to purchase bundle",e),t({variant:"destructive",title:"Error",description:e.message||"Could not complete the purchase."})}}},V=async()=>{if(e&&s){if(s.rubyCount<5)return void t({variant:"destructive",title:"Not Enough Rubies",description:"You need ".concat(5," rubies.")});try{await (0,B.R)(e.uid,5),n("reward"),t({title:"Purchase Successful!",description:"You bought a Plant Chat token. Use it on a max-level plant!"})}catch(e){console.error("Failed to purchase plant chat",e),t({variant:"destructive",title:"Error",description:e.message||"Could not complete the purchase."})}}},H=()=>{t({title:"Coming Soon!",description:"Real-money purchases are not yet implemented."})};if(!e||!s)return(0,l.jsx)("div",{className:"flex h-screen w-full items-center justify-center",children:(0,l.jsx)(o.A,{className:"h-8 w-8 animate-spin text-primary"})});let Q=s.gold,q=s.rubyCount,K=s.draws;return(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("header",{className:"flex flex-col items-center justify-center pb-4 text-center",children:[(0,l.jsx)("h1",{className:"text-3xl text-primary",children:"Shop"}),(0,l.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 rounded-full bg-yellow-100/80 px-3 py-1 border border-yellow-300/80",children:[(0,l.jsx)(d.A,{className:"h-5 w-5 text-yellow-500"}),(0,l.jsx)("span",{className:"font-bold text-yellow-700",children:Q})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 rounded-full bg-red-100/80 px-3 py-1 border border-red-300/80",children:[(0,l.jsx)(x.A,{className:"h-5 w-5 text-red-500"}),(0,l.jsx)("span",{className:"font-bold text-red-700",children:q})]})]})]}),(0,l.jsxs)("div",{className:"grid gap-6",children:[(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(h.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Daily Free Draw"}),(0,l.jsx)(r.BT,{children:"Claim one free draw every day after watching an ad."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-chart-3",children:"FREE"}),(0,l.jsx)(a.$,{onClick:()=>{Z(!0)},className:"w-full font-semibold",disabled:K>=c.RY||E,children:E?"Claimed for Today":K>=c.RY?"Draws Full":"Claim"}),E&&(0,l.jsxs)("div",{className:"text-xs text-muted-foreground text-center w-full flex items-center justify-center gap-1.5",children:[(0,l.jsx)(u.A,{className:"w-3 h-3"}),(0,l.jsxs)("span",{children:["Next free draw in ",A]})]})]})]}),(0,l.jsx)(k.w,{}),(0,l.jsxs)(r.Zp,{className:"shadow-sm border-purple-500/50",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(m.A,{className:"h-8 w-8 text-purple-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl text-purple-600",children:"Premium Shop"}),(0,l.jsx)(r.BT,{children:"Special items available for purchase."})]})]})}),(0,l.jsxs)(r.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-purple-50",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-purple-800",children:"Seasonal Plant Pack"}),(0,l.jsx)("p",{className:"text-sm text-purple-600",children:"Get 5 exclusive seasonal plants!"})]}),(0,l.jsx)(a.$,{onClick:H,className:"bg-purple-500 hover:bg-purple-600",children:"$4.99"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-purple-50",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-purple-800",children:"Fertilizer"}),(0,l.jsx)("p",{className:"text-sm text-purple-600",children:"Reduces seed time by 8 hours."})]}),(0,l.jsx)(a.$,{onClick:H,className:"bg-purple-500 hover:bg-purple-600",children:"$0.50"})]})]})]}),(0,l.jsx)(k.w,{}),(0,l.jsxs)(r.Zp,{className:"shadow-sm border-red-500/50",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(p.A,{className:"h-8 w-8 text-red-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl text-red-600",children:"Plant Chat Token"}),(0,l.jsx)(r.BT,{children:"Unlock the ability to chat with one of your max-level plants."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.A,{className:"h-6 w-6 text-red-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-red-600",children:5})]}),(0,l.jsx)(a.$,{onClick:V,variant:"destructive",className:"w-full font-semibold bg-red-500 hover:bg-red-600",disabled:q<5,children:q<5?"Not Enough Rubies":"Buy Chat Token"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground text-center w-full",children:["You have ",s.plantChatTokens," token(s)"]})]})]}),(0,l.jsx)(k.w,{}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(f.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Sparkle Bundle"}),(0,l.jsx)(r.BT,{children:"A pack of all cosmetics plus a refill! 10 gold off!"})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:215})]}),(0,l.jsx)(a.$,{onClick:L,className:"w-full font-semibold",disabled:Q<215,children:Q<215?"Not Enough Gold":"Buy Bundle"})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(j.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Buy a Draw"}),(0,l.jsx)(r.BT,{children:"Use your gold to get another draw."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:50})]}),(0,l.jsx)(a.$,{onClick:J,className:"w-full font-semibold",disabled:Q<50||K>=c.RY,children:K>=c.RY?"Draws Full":Q<50?"Not Enough Gold":"Buy Draw"})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(w.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Sprinkler"}),(0,l.jsx)(r.BT,{children:"A one-time purchase to water all your eligible plants at once."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:100})]}),(0,l.jsx)(a.$,{onClick:I,className:"w-full font-semibold",disabled:s.sprinklerUnlocked||Q<100,children:s.sprinklerUnlocked?"Owned":Q<100?"Not Enough Gold":"Buy"})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(N.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Water Refill"}),(0,l.jsx)(r.BT,{children:"Buy a refill to reset a single plant's daily watering limit."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:15})]}),(0,l.jsx)(a.$,{onClick:_,className:"w-full font-semibold",disabled:Q<15,children:Q<15?"Not Enough Gold":"Buy (+1)"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground text-center w-full",children:["You have ",s.waterRefillCount," refill(s)"]})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(g.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Glitter Pack"}),(0,l.jsx)(r.BT,{children:"Make one of your plants permanently sparkle with glitter."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:50})]}),(0,l.jsx)(a.$,{onClick:M,className:"w-full font-semibold",disabled:Q<50,children:Q<50?"Not Enough Gold":"Buy Glitter (+1)"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground text-center w-full",children:["You have ",s.glitterCount," pack(s)"]})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(v.A,{className:"h-8 w-8 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Sheen Pack"}),(0,l.jsx)(r.BT,{children:"Make one of your plants permanently shimmer with a beautiful sheen."})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:50})]}),(0,l.jsx)(a.$,{onClick:O,className:"w-full font-semibold",disabled:Q<50,children:Q<50?"Not Enough Gold":"Buy Sheen (+1)"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground text-center w-full",children:["You have ",s.sheenCount," sheen pack(s)"]})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(g.A,{className:"h-8 w-8 text-pink-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Rainbow Glitter"}),(0,l.jsx)(r.BT,{children:"Make one of your plants sparkle with all the colors of the rainbow!"})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:60})]}),(0,l.jsx)(a.$,{onClick:U,className:"w-full font-semibold",disabled:Q<60,children:Q<60?"Not Enough Gold":"Buy Glitter (+1)"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground text-center w-full",children:["You have ",s.rainbowGlitterCount," pack(s)"]})]})]}),(0,l.jsxs)(r.Zp,{className:"shadow-sm",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(g.A,{className:"h-8 w-8 text-red-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(r.ZB,{className:"text-xl",children:"Red Glitter"}),(0,l.jsx)(r.BT,{children:"Make one of your plants sparkle with a fiery red glitter!"})]})]})}),(0,l.jsxs)(r.Wu,{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{className:"h-6 w-6 text-yellow-500"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:50})]}),(0,l.jsx)(a.$,{onClick:z,className:"w-full font-semibold",disabled:Q<50,children:Q<50?"Not Enough Gold":"Buy Glitter (+1)"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground text-center w-full",children:["You have ",s.redGlitterCount," pack(s)"]})]})]})]})]}),(0,l.jsx)(R,{open:P,onOpenChange:Z,onSkip:W,countdown:F})]})}},6259:(e,s,t)=>{"use strict";t.d(s,{w:()=>c});var l=t(5155),a=t(2115),r=t(7268),i=t(4269);let c=a.forwardRef((e,s)=>{let{className:t,orientation:a="horizontal",decorative:c=!0,...n}=e;return(0,l.jsx)(r.b,{ref:s,decorative:c,orientation:a,className:(0,i.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",t),...n})});c.displayName=r.b.displayName},8243:(e,s,t)=>{Promise.resolve().then(t.bind(t,4939))}},e=>{e.O(0,[992,416,760,7,476,667,737,184,482,441,255,358],()=>e(e.s=8243)),_N_E=e.O()}]);