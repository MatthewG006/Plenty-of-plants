(()=>{var e={};e.id=974,e.ids=[974],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11329:(e,t,r)=>{"use strict";r.d(t,{DX:()=>l});var s=r(43210);function n(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var a=r(60687),l=function(e){let t=function(e){let t=s.forwardRef((e,t)=>{let{children:r,...a}=e;if(s.isValidElement(r)){var l;let e,i,o=(l=r,(i=(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(i=(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref),u=function(e,t){let r={...t};for(let s in t){let n=e[s],a=t[s];/^on[A-Z]/.test(s)?n&&a?r[s]=(...e)=>{let t=a(...e);return n(...e),t}:n&&(r[s]=n):"style"===s?r[s]={...n,...a}:"className"===s&&(r[s]=[n,a].filter(Boolean).join(" "))}return{...e,...r}}(a,r.props);return r.type!==s.Fragment&&(u.ref=t?function(...e){return t=>{let r=!1,s=e.map(e=>{let s=n(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():n(e[t],null)}}}}(t,o):o),s.cloneElement(r,u)}return s.Children.count(r)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=s.forwardRef((e,r)=>{let{children:n,...l}=e,i=s.Children.toArray(n),u=i.find(o);if(u){let e=u.props.children,n=i.map(t=>t!==u?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...l,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,a.jsx)(t,{...l,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}("Slot"),i=Symbol("radix.slottable");function o(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===i}},18780:(e,t,r)=>{"use strict";r.d(t,{A:()=>f,AuthProvider:()=>p});var s=r(60687),n=r(43210),a=r(57782),l=r(33784),i=r(75535),o=r(11516),u=r(53125),d=r(16189);let c=(0,n.createContext)({user:null,gameData:null,loading:!0}),p=({children:e})=>{let[t,r]=(0,n.useState)(null),[p,f]=(0,n.useState)(null),[m,w]=(0,n.useState)(!0),h=(0,d.useRouter)(),x=(0,d.usePathname)();return((0,n.useEffect)(()=>{let e=(0,a.hg)(l.j,e=>{r(e),e||(f(null),w(!1))});return()=>e()},[]),(0,n.useEffect)(()=>{let e;if(t){w(!0);let r=(0,i.H9)(l.db,"users",t.uid);e=(0,i.aQ)(r,e=>{if(e.exists()){let t=e.data();f({gold:t.gold||0,plants:t.plants||{},collectionPlantIds:t.collectionPlantIds||[],deskPlantIds:t.deskPlantIds||[,,,].fill(null),draws:t.draws??u.RY,lastDrawRefill:t.lastDrawRefill||Date.now(),lastFreeDrawClaimed:t.lastFreeDrawClaimed||0,waterRefills:t.waterRefills||0})}else f(null);w(!1)},e=>{console.error("Firestore snapshot error:",e),f(null),w(!1)})}else w(!1);return()=>{e&&e()}},[t]),(0,n.useEffect)(()=>{if(m)return;let e=["/login","/signup"].includes(x);"/"!==x&&(t||e||h.push("/login"))},[t,m,x,h]),m&&"/"!==x)?(0,s.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:(0,s.jsx)(o.A,{className:"h-12 w-12 animate-spin text-primary"})}):(0,s.jsx)(c.Provider,{value:{user:t,gameData:p,loading:m},children:e})},f=()=>{let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21204:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/page.tsx","default")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29523:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>u});var s=r(60687),n=r(43210),a=r(11329),l=r(24224),i=r(4780),o=r(86632);let u=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,onClick:l,disableSfx:d=!1,...c},p)=>{let f=n?a.DX:"button",{playSfx:m}=(0,o.G)();return(0,s.jsx)(f,{className:(0,i.cn)(u({variant:t,size:r,className:e})),ref:p,onClick:e=>{d||m("tap"),l&&l(e)},...c})});d.displayName="Button"},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},53125:(e,t,r)=>{"use strict";r.d(t,{$k:()=>d,RY:()=>l,h$:()=>u,iF:()=>o,mi:()=>i});var s=r(75535),n=r(33784),a=r(79396);let l=2;async function i(e){let t=await (0,a.Uc)(e);if(!t)return;let r=Date.now(),i=t.draws;if(i<l){let a=t.lastDrawRefill||r,o=r-a;if(o>=432e5){let t=Math.min(i+Math.floor(o/432e5),l);if(t>i){let a=(0,s.H9)(n.db,"users",e);await (0,s.mZ)(a,{draws:t,lastDrawRefill:r})}}}}async function o(e){let t=await (0,a.Uc)(e);if(t&&t.draws>0){let r={draws:t.draws-1};t.draws===l&&(r.lastDrawRefill=Date.now());let a=(0,s.H9)(n.db,"users",e);await (0,s.mZ)(a,r)}}async function u(e){let t=await (0,a.Uc)(e);return!!t&&!!t.lastFreeDrawClaimed&&new Date(t.lastFreeDrawClaimed).toDateString()===new Date().toDateString()}async function d(e,t){let r=await (0,a.Uc)(e);if(!r)return{success:!1,newCount:0};let i=r.draws||0;if(i>=l)return{success:!1,newCount:i,reason:"max_draws"};if(!t?.bypassTimeCheck&&await u(e))return{success:!1,newCount:i,reason:"already_claimed"};if(t?.cost&&r.gold<t.cost)return{success:!1,newCount:i};let o=i+1,d=Date.now(),c=(0,s.H9)(n.db,"users",e),p={draws:o};return t?.bypassTimeCheck||(p.lastFreeDrawClaimed=d),t?.cost&&(p.gold=(0,s.GV)(-t.cost)),o===l&&(p.lastDrawRefill=d),await (0,s.mZ)(c,p),{success:!0,newCount:o}}},55511:e=>{"use strict";e.exports=require("crypto")},57521:(e,t,r)=>{Promise.resolve().then(r.bind(r,75694))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67249:(e,t,r)=>{Promise.resolve().then(r.bind(r,21204))},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},75694:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(60687),n=r(30474),a=r(29523),l=r(86632),i=r(18780),o=r(16189);function u(){let{isPlaying:e,togglePlay:t,playSfx:r}=(0,l.G)(),{user:u}=(0,i.A)(),d=(0,o.useRouter)();return(0,s.jsxs)("div",{className:"flex h-screen w-full flex-col items-center justify-between p-4 bg-splash-image",children:[(0,s.jsx)("div",{className:"flex-grow-[1] z-10"}),(0,s.jsxs)("div",{className:"z-10 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[(0,s.jsx)(n.default,{src:"/logo.png",alt:"Plenty of Plants Logo",width:320,height:320,className:"","data-ai-hint":"plant logo"}),(0,s.jsx)("p",{className:"text-lg text-white font-bold -mt-16",style:{textShadow:"0 2px 4px rgba(0,0,0,1)"},children:"Your Digital Conservatory Awaits."}),(0,s.jsx)(a.$,{onClick:()=>{e||t(),r("whoosh"),d.push(u?"/home":"/login")},className:"mt-12 animate-pulse-subtle",size:"lg",disableSfx:!0,children:(0,s.jsx)("span",{className:"text-xl px-8",children:"Tap to Enter"})})]}),(0,s.jsx)("div",{className:"flex-grow-[3] z-10"})]})}},79396:(e,t,r)=>{"use strict";r.d(t,{B2:()=>p,E6:()=>f,Jt:()=>o,LS:()=>m,Uc:()=>l,VS:()=>u,Z8:()=>c,dq:()=>w,hj:()=>d,uq:()=>i});var s=r(75535),n=r(33784),a=r(53125);async function l(e){let t=(0,s.H9)(n.db,"users",e),r=await (0,s.x7)(t);if(!r.exists())return null;{let e=r.data();return{gold:e.gold||0,plants:e.plants||{},collectionPlantIds:e.collectionPlantIds||[],deskPlantIds:e.deskPlantIds||[,,,].fill(null),draws:e.draws??a.RY,lastDrawRefill:e.lastDrawRefill||Date.now(),lastFreeDrawClaimed:e.lastFreeDrawClaimed||0,waterRefills:e.waterRefills||0}}}async function i(e,t){let r=await l(e);return r&&r.plants&&r.plants[t]||null}async function o(e){let t=(0,s.H9)(n.db,"users",e.uid);if(!(await (0,s.x7)(t)).exists()){let r=Math.floor(360*Math.random()),n=`hsl(${r}, 70%, 85%)`;await (0,s.BN)(t,{email:e.email,username:e.displayName,avatarColor:n,gold:0,plants:{1:{id:1,name:"Friendly Fern",description:"A happy little fern to start your collection.",image:"/fern.png",form:"Base",hint:"fern plant",level:1,xp:0,lastWatered:[]}},collectionPlantIds:[],deskPlantIds:[1,null,null],gameId:`#${e.uid.slice(0,8).toUpperCase()}`,draws:a.RY,lastDrawRefill:Date.now(),lastFreeDrawClaimed:0,waterRefills:0})}}async function u(e,t){let r=(0,s.H9)(n.db,"users",e),a=await l(e);if(!a)throw Error("User data not found, cannot save plant.");let i=JSON.parse(JSON.stringify(t)),o=Object.keys(a.plants).map(Number),u={id:(o.length>0?Math.max(...o):0)+1,name:i.name,form:"Base",image:i.imageDataUri,hint:i.name.toLowerCase().split(" ").slice(0,2).join(" "),description:i.description,level:1,xp:0,lastWatered:[]},d=a.deskPlantIds.findIndex(e=>null===e),c={[`plants.${u.id}`]:u};if(-1!==d){let e=[...a.deskPlantIds];e[d]=u.id,c.deskPlantIds=e}else c.collectionPlantIds=(0,s.hq)(u.id);return await (0,s.mZ)(r,c),u}async function d(e,t,r){await (0,s.mZ)((0,s.H9)(n.db,"users",e),{collectionPlantIds:t,deskPlantIds:r})}async function c(e,t,r){let a=(0,s.H9)(n.db,"users",e),l={};for(let[e,s]of Object.entries(r))l[`plants.${t}.${e}`]=s;Object.keys(l).length>0&&await (0,s.mZ)(a,l)}async function p(e,t){let r=(0,s.H9)(n.db,"users",e);await (0,s.mZ)(r,{gold:(0,s.GV)(t)})}async function f(e,t,r){let a=(0,s.H9)(n.db,"users",e),i=await l(e);if(!i||i.gold<r)throw Error("Not enough gold to purchase.");await (0,s.mZ)(a,{gold:(0,s.GV)(-r),waterRefills:(0,s.GV)(t)})}async function m(e){let t=(0,s.H9)(n.db,"users",e),r=await l(e);if(!r||r.waterRefills<=0)throw Error("No water refills to use.");await (0,s.mZ)(t,{waterRefills:(0,s.GV)(-1)})}async function w(e){let t=(0,s.H9)(n.db,"users",e);await (0,s.mZ)(t,{plants:{1:{id:1,name:"Friendly Fern",description:"A happy little fern to start your collection.",image:"/fern.png",form:"Base",hint:"fern plant",level:1,xp:0,lastWatered:[]}},collectionPlantIds:[],deskPlantIds:[1,null,null],gold:0,draws:a.RY,lastDrawRefill:Date.now(),lastFreeDrawClaimed:0,waterRefills:0})}},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},90462:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>c,pages:()=>d,routeModule:()=>p,tree:()=>u});var s=r(65239),n=r(48088),a=r(88170),l=r.n(a),i=r(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let u={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,21204)),"/home/user/studio/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/home/user/studio/src/app/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,611,335,474,213],()=>r(90462));module.exports=s})();