(()=>{var e={};e.id=539,e.ids=[539],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21114:(e,t,r)=>{Promise.resolve().then(r.bind(r,77003))},21820:e=>{"use strict";e.exports=require("os")},24386:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"007c3e545aff6f125174734bb934867686df960b4e":()=>c});var s=r(91199);r(42087);var a=r(37612),i=r(56758);if(!process.env.GOOGLE_API_KEY)throw Error("GOOGLE_API_KEY environment variable not set. Please provide your API key in the .env file.");let o=(0,a.genkit)({plugins:[(0,i.YF)({apiKey:process.env.GOOGLE_API_KEY})],model:"googleai/gemini-2.0-flash"});var n=r(33331);let l=a.z.object({}),d=a.z.object({name:a.z.string().describe("The creative and unique name of the new plant."),description:a.z.string().describe("A short, whimsical description of the plant."),imageDataUri:a.z.string().describe("A generated image of the plant, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'")});async function c(){return p({})}let u=o.definePrompt({name:"plantDetailsPrompt",input:{schema:l},output:{schema:a.z.object({name:a.z.string().describe("A creative and unique name for a new fantasy plant. Should be two words."),description:a.z.string().describe("A short, whimsical description for this new plant, in one sentence."),imagePrompt:a.z.string().describe('A simple visual prompt for an image generation model to create a picture of this plant. e.g., "A whimsical glowing mushroom plant with a happy face."')})},prompt:"You are a creative botanist for a game about collecting magical plants. Generate one new, unique, and whimsical plant. The plant should have a two-word name, a short one-sentence description, and a prompt for an image generator. The plant should sound like a cute character."}),p=o.defineFlow({name:"drawPlantFlow",inputSchema:l,outputSchema:d},async()=>{let{output:e}=await u({}),{media:t}=await o.generate({model:"googleai/gemini-2.0-flash-preview-image-generation",prompt:`A cute, 2D vector art illustration of a magical plant character: ${e.imagePrompt}. The plant should be in a simple terracotta pot with a happy, smiling face. The style should be clean, with bold outlines, suitable for a mobile game. The background must be solid white.`,config:{responseModalities:["TEXT","IMAGE"]}});if(!t)throw Error("Could not generate plant image.");return{name:e.name,description:e.description,imageDataUri:t.url}});(0,n.D)([c]),(0,s.A)(c,"007c3e545aff6f125174734bb934867686df960b4e",null)},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37830:e=>{"use strict";e.exports=require("node:stream/web")},44708:e=>{"use strict";e.exports=require("node:https")},47002:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=47002,e.exports=t},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},58595:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63503:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>p,Es:()=>h,HM:()=>c,L3:()=>f,c7:()=>m,lG:()=>l});var s=r(60687),a=r(43210),i=r(1553),o=r(78726),n=r(4780);let l=i.bL;i.l9;let d=i.ZL,c=i.bm,u=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.hJ,{ref:r,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));u.displayName=i.hJ.displayName;let p=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(i.UC,{ref:a,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,(0,s.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));p.displayName=i.UC.displayName;let m=({className:e,...t})=>(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});m.displayName="DialogHeader";let h=({className:e,...t})=>(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});h.displayName="DialogFooter";let f=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.hE,{ref:r,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));f.displayName=i.hE.displayName,a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.VY,{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t})).displayName=i.VY.displayName},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},76760:e=>{"use strict";e.exports=require("node:path")},77003:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>q});var s=r(60687),a=r(29523),i=r(44493),o=r(82614);let n=(0,o.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var l=r(58595),d=r(81292);let c=(0,o.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var u=r(78726),p=r(11516),m=r(85814),h=r.n(m),f=r(30474),x=r(43210),g=r(88526),w=r(29867),b=r(63503);let v="plenty-of-plants-data";async function y(e){let t=await fetch(e),r=await t.blob();return new Promise((e,t)=>{let s=new FileReader;s.onloadend=()=>e(s.result),s.onerror=t,s.readAsDataURL(r)})}async function j(e,t=256){return new Promise((r,s)=>{let a=new window.Image;a.onload=()=>{let e=document.createElement("canvas"),{width:i,height:o}=a;i>o?i>t&&(o=Math.round(o*t/i),i=t):o>t&&(i=Math.round(i*t/o),o=t),e.width=i,e.height=o;let n=e.getContext("2d");if(!n)return s(Error("Could not get canvas context"));n.drawImage(a,0,0,i,o),r(e.toDataURL("image/png"))},a.onerror=s,a.src=e})}function N({plant:e,open:t,onOpenChange:r}){return e?(0,s.jsx)(b.lG,{open:t,onOpenChange:r,children:(0,s.jsxs)(b.Cf,{className:"max-w-sm",children:[(0,s.jsx)(b.c7,{children:(0,s.jsx)(b.L3,{className:"font-headline text-3xl text-center",children:"A new plant!"})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 py-4",children:[(0,s.jsx)("div",{className:"w-64 h-64 rounded-lg overflow-hidden border-4 border-primary/50 shadow-lg bg-green-100",children:(0,s.jsx)(f.default,{src:e.imageDataUri,alt:e.name,width:256,height:256,className:"object-cover w-full h-full"})}),(0,s.jsx)("h3",{className:"text-2xl font-headline text-primary",children:e.name}),(0,s.jsx)("p",{className:"text-muted-foreground text-center",children:e.description})]}),(0,s.jsx)(b.Es,{children:(0,s.jsx)(b.HM,{asChild:!0,children:(0,s.jsx)(a.$,{className:"w-full font-headline text-lg",children:"Collect"})})})]})}):null}function q(){let{toast:e}=(0,w.dj)(),[t,r]=(0,x.useState)(null),[o,m]=(0,x.useState)(!1),[b,q]=(0,x.useState)(null),P=async()=>{m(!0);try{let e,t;try{let t=localStorage.getItem(v);e=t?JSON.parse(t):{collection:[],desk:[]}}catch(t){console.error("Failed to read or parse localStorage",t),e={collection:[],desk:[]}}let r=[...e.collection||[],...(e.desk||[]).filter(e=>null!==e)];t=0===r.length?{name:"Friendly Fern",description:"A happy little fern to start your collection.",imageDataUri:await y("/fern.png")}:await (0,g.a)();let s=await j(t.imageDataUri);q({...t,imageDataUri:s})}catch(t){console.error(t),e({variant:"destructive",title:"Failed to draw a plant",description:"There was an issue with the AI. Please try again."})}finally{m(!1)}},k=async()=>{let t;if(!b)return;try{let e=localStorage.getItem(v);t=e?JSON.parse(e):{collection:[],desk:[,,,].fill(null)}}catch(e){console.error("Failed to read or parse localStorage",e),t={collection:[],desk:[,,,].fill(null)}}let s=t.collection||[],a=t.desk||[,,,].fill(null),i={id:[...s,...a.filter(e=>null!==e)].reduce((e,t)=>Math.max(t.id,e),0)+1,name:b.name,form:"Base",image:b.imageDataUri,hint:"Friendly Fern"===b.name?"fern plant":b.name.toLowerCase().split(" ").slice(0,2).join(" "),description:b.description},o={collection:[...s,...a.filter(e=>null!==e),i].filter(e=>!a.some(t=>t?.id===e.id)),desk:a};try{localStorage.setItem(v,JSON.stringify(o))}catch(t){console.error("Failed to save to localStorage (quota may be exceeded)",t),e({variant:"destructive",title:"Storage Error",description:"Could not save your new plant. Your device storage might be full."})}r(i),q(null)};return(0,s.jsxs)("div",{className:"p-4 space-y-6 bg-background",children:[(0,s.jsxs)("header",{className:"flex flex-col items-center space-y-2",children:[(0,s.jsx)("h1",{className:"font-headline text-3xl text-chart-2 font-bold",children:"Plenty Of Plants"}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)(a.$,{variant:"outline",size:"sm",asChild:!0,children:(0,s.jsxs)(h(),{href:"/settings",children:[(0,s.jsx)(n,{className:"mr-2 h-4 w-4"}),"Settings"]})}),(0,s.jsx)(a.$,{variant:"outline",size:"sm",asChild:!0,children:(0,s.jsxs)(h(),{href:"/profile",children:[(0,s.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Profile"]})})]})]}),(0,s.jsxs)("main",{className:"space-y-6",children:[(0,s.jsxs)(i.Zp,{className:"shadow-sm",children:[(0,s.jsx)(i.aR,{children:(0,s.jsx)(i.ZB,{className:"text-xl font-semibold text-center",children:"Your Latest Collection"})}),(0,s.jsx)(i.Wu,{className:"flex flex-col items-center justify-center text-center min-h-[260px]",children:t?(0,s.jsxs)(h(),{href:"/room",className:"flex flex-col items-center gap-4 transition-transform hover:scale-105",children:[(0,s.jsx)("div",{className:"w-48 h-48 rounded-lg overflow-hidden border-2 border-primary/30 shadow-md",children:"placeholder"!==t.image?(0,s.jsx)(f.default,{src:t.image,alt:t.name,width:192,height:192,className:"object-cover w-full h-full","data-ai-hint":t.hint}):(0,s.jsx)("div",{className:"w-full h-full bg-muted flex items-center justify-center",children:(0,s.jsx)(d.A,{className:"w-16 h-16 text-muted-foreground"})})}),(0,s.jsx)("h3",{className:"text-xl font-headline text-primary",children:t.name})]}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"No plants collected yet. Time to draw one!"})})]}),(0,s.jsxs)(i.Zp,{className:"shadow-sm",children:[(0,s.jsx)(i.aR,{className:"items-center",children:(0,s.jsx)(i.ZB,{className:"text-xl font-semibold",children:"Free Draws Available"})}),(0,s.jsxs)(i.Wu,{className:"flex flex-col items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full bg-chart-3",children:(0,s.jsx)(c,{className:"h-8 w-8 text-white"})}),(0,s.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full bg-muted",children:(0,s.jsx)(u.A,{className:"h-8 w-8 text-destructive"})})]}),(0,s.jsx)(a.$,{onClick:P,disabled:o,size:"lg",className:"w-full font-semibold rounded-full mt-2",children:o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Drawing..."]}):"Draw New Plant"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"New draw available every 12 hours (max 2 slots)."})]})]})]}),(0,s.jsx)(N,{plant:b,open:!!b,onOpenChange:e=>{e||k()}})]})}},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81202:(e,t,r)=>{Promise.resolve().then(r.bind(r,97551))},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},88526:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var s=r(6475);let a=(0,s.createServerReference)("007c3e545aff6f125174734bb934867686df960b4e",s.callServer,void 0,s.findSourceMapURL,"drawPlant")},89708:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(65239),a=r(48088),i=r(88170),o=r.n(i),n=r(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let d={children:["",{children:["(app)",{children:["home",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,97551)),"/home/user/studio/src/app/(app)/home/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,70718)),"/home/user/studio/src/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/(app)/home/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(app)/home/page",pathname:"/home",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},97551:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/(app)/home/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/(app)/home/page.tsx","default")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,611,567,730,637,251],()=>r(89708));module.exports=s})();