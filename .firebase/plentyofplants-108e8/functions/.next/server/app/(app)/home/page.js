(()=>{var e={};e.id=539,e.ids=[539],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21114:(e,t,r)=>{Promise.resolve().then(r.bind(r,77003))},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37830:e=>{"use strict";e.exports=require("node:stream/web")},44708:e=>{"use strict";e.exports=require("node:https")},47002:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=47002,e.exports=t},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},58595:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(82614).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},59784:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"007c3e545aff6f125174734bb934867686df960b4e":()=>v});var a=r(91199);r(42087);var s=r(37612),i=r(56758);if(!process.env.GOOGLE_API_KEY)throw Error("GOOGLE_API_KEY environment variable not set. Please provide your API key in the .env file.");let n=(0,s.genkit)({plugins:[(0,i.YF)({apiKey:process.env.GOOGLE_API_KEY})],model:"googleai/gemini-2.0-flash"});var o=r(79748),l=r.n(o),c=r(33873),d=r.n(c),u=r(33331);let p=d().join(process.cwd(),"public","fallback-plants"),m=[{name:"Sunny Succulent",file:"succulent.png"},{name:"Happy Cactus",file:"cactus.png"},{name:"Blushing Bloom",file:"flower.png"}];async function h(e,t){let r=(await l().readFile(e)).toString("base64");return`data:${t};base64,${r}`}let f=s.z.object({name:s.z.string().describe("The creative and unique name of the new plant."),description:s.z.string().describe("A short, whimsical description of the plant."),imageDataUri:s.z.string().describe("A generated image of the plant, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'")}),x=n.definePrompt({name:"fallbackPlantDetailsPrompt",input:{schema:s.z.object({plantType:s.z.string()})},output:{schema:s.z.object({name:s.z.string().describe("A creative and unique two-word name for this type of plant."),description:s.z.string().describe("A short, whimsical, one-sentence description for this plant.")})},prompt:'You are a creative botanist for a game. Based on the plant type "{{plantType}}", generate a unique two-word name and a whimsical one-sentence description for it.'}),g=n.defineFlow({name:"getFallbackPlantFlow",inputSchema:s.z.object({}),outputSchema:f},async()=>{let e=m[Math.floor(Math.random()*m.length)],t=d().join(p,e.file);try{let r=await h(t,"image/png"),{output:a}=await x({plantType:e.name});if(!a)throw Error("Could not generate details for hardcoded fallback.");return{name:a.name,description:a.description,imageDataUri:r}}catch(e){return console.error("Critical error: Could not load hardcoded fallback image.",e),{name:"Resilient Sprout",description:"This little sprout survived a digital apocalypse to be here!",imageDataUri:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"}}});(0,u.D)([g]),(0,a.A)(g,"7f49d206c7f575a34b5e8cf6868734d3675e6ddbbc",null);let b=s.z.object({}),w=s.z.object({name:s.z.string().describe("The creative and unique name of the new plant."),description:s.z.string().describe("A short, whimsical description of the plant."),imageDataUri:s.z.string().describe("A generated image of the plant, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'")});async function v(){return j({})}let y=n.definePrompt({name:"plantDetailsPrompt",input:{schema:b},output:{schema:s.z.object({name:s.z.string().describe("A creative and unique name for a new fantasy plant. Should be two words."),description:s.z.string().describe("A short, whimsical description for this new plant, in one sentence."),imagePrompt:s.z.string().describe('A simple visual prompt for an image generation model to create a picture of this plant. e.g., "A whimsical glowing mushroom plant with a happy face."')})},prompt:"You are a creative botanist for a game about collecting magical plants. Generate one new, unique, and whimsical plant. The plant should have a two-word name, a short one-sentence description, and a prompt for an image generator. The plant should sound like a cute character."}),j=n.defineFlow({name:"drawPlantFlow",inputSchema:b,outputSchema:w},async()=>{try{let{output:e}=await y({});if(!e)throw Error("Could not generate plant details.");let{media:t}=await n.generate({model:"googleai/gemini-2.0-flash-preview-image-generation",prompt:`A cute, 2D vector art illustration of a magical plant character: ${e.imagePrompt}. The plant should be in a simple terracotta pot with a happy, smiling face. The style should be clean, with bold outlines, suitable for a mobile game. The background must be solid white.`,config:{responseModalities:["TEXT","IMAGE"]}});if(!t||!t.url)throw Error("Could not generate plant image.");return{name:e.name,description:e.description,imageDataUri:t.url}}catch(e){return console.error("Gemini image generation failed, using fallback.",e),await g({})}});(0,u.D)([v]),(0,a.A)(v,"007c3e545aff6f125174734bb934867686df960b4e",null)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63503:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>p,Es:()=>h,HM:()=>d,L3:()=>f,c7:()=>m,lG:()=>l});var a=r(60687),s=r(43210),i=r(1553),n=r(78726),o=r(4780);let l=i.bL;i.l9;let c=i.ZL,d=i.bm,u=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(i.hJ,{ref:r,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));u.displayName=i.hJ.displayName;let p=s.forwardRef(({className:e,children:t,...r},s)=>(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(i.UC,{ref:s,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,(0,a.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));p.displayName=i.UC.displayName;let m=({className:e,...t})=>(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});m.displayName="DialogHeader";let h=({className:e,...t})=>(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});h.displayName="DialogFooter";let f=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(i.hE,{ref:r,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));f.displayName=i.hE.displayName,s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(i.VY,{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",e),...t})).displayName=i.VY.displayName},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},76760:e=>{"use strict";e.exports=require("node:path")},77003:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var a=r(60687),s=r(29523),i=r(44493),n=r(82614);let o=(0,n.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var l=r(58595),c=r(81292);let d=(0,n.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var u=r(78726),p=r(11516),m=r(85814),h=r.n(m),f=r(30474),x=r(43210),g=r(88526),b=r(29867),w=r(63503);let v="plenty-of-plants-data";async function y(e){let t=await fetch(e),r=await t.blob();return new Promise((e,t)=>{let a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=t,a.readAsDataURL(r)})}async function j(e,t=256){return new Promise((r,a)=>{let s=new window.Image;s.onload=()=>{let e=document.createElement("canvas"),{width:i,height:n}=s;i>n?i>t&&(n=Math.round(n*t/i),i=t):n>t&&(i=Math.round(i*t/n),n=t),e.width=i,e.height=n;let o=e.getContext("2d");if(!o)return a(Error("Could not get canvas context"));o.drawImage(s,0,0,i,n),r(e.toDataURL("image/png"))},s.onerror=a,s.src=e})}function A({plant:e,open:t,onOpenChange:r}){return e?(0,a.jsx)(w.lG,{open:t,onOpenChange:r,children:(0,a.jsxs)(w.Cf,{className:"max-w-sm",children:[(0,a.jsx)(w.c7,{children:(0,a.jsx)(w.L3,{className:"font-headline text-3xl text-center",children:"A new plant!"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 py-4",children:[(0,a.jsx)("div",{className:"w-64 h-64 rounded-lg overflow-hidden border-4 border-primary/50 shadow-lg bg-green-100",children:(0,a.jsx)(f.default,{src:e.imageDataUri,alt:e.name,width:256,height:256,className:"object-cover w-full h-full"})}),(0,a.jsx)("h3",{className:"text-2xl font-headline text-primary",children:e.name}),(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:e.description})]}),(0,a.jsx)(w.Es,{children:(0,a.jsx)(w.HM,{asChild:!0,children:(0,a.jsx)(s.$,{className:"w-full font-headline text-lg",children:"Collect"})})})]})}):null}function N(){let{toast:e}=(0,b.dj)(),[t,r]=(0,x.useState)(null),[n,m]=(0,x.useState)(!1),[w,N]=(0,x.useState)(null),q=async()=>{m(!0);try{let e,t;try{let t=localStorage.getItem(v);e=t?JSON.parse(t):{collection:[],desk:[]}}catch(t){console.error("Failed to read or parse localStorage",t),e={collection:[],desk:[]}}let r=[...e.collection||[],...(e.desk||[]).filter(e=>null!==e)];t=0===r.length?{name:"Friendly Fern",description:"A happy little fern to start your collection.",imageDataUri:await y("/fern.png")}:await (0,g.a)();let a=await j(t.imageDataUri);N({...t,imageDataUri:a})}catch(t){console.error(t),e({variant:"destructive",title:"Failed to draw a plant",description:"There was an issue with the AI. Please try again."})}finally{m(!1)}},P=async()=>{let t;if(!w)return;try{let e=localStorage.getItem(v);t=e?JSON.parse(e):{collection:[],desk:[,,,].fill(null)}}catch(e){console.error("Failed to read or parse localStorage",e),t={collection:[],desk:[,,,].fill(null)}}let a=t.collection||[],s=t.desk||[,,,].fill(null),i={id:[...a,...s.filter(e=>null!==e)].reduce((e,t)=>Math.max(t.id,e),0)+1,name:w.name,form:"Base",image:w.imageDataUri,hint:"Friendly Fern"===w.name?"fern plant":w.name.toLowerCase().split(" ").slice(0,2).join(" "),description:w.description},n={collection:[...a,...s.filter(e=>null!==e),i].filter(e=>!s.some(t=>t?.id===e.id)),desk:s};try{localStorage.setItem(v,JSON.stringify(n))}catch(t){console.error("Failed to save to localStorage (quota may be exceeded)",t),e({variant:"destructive",title:"Storage Error",description:"Could not save your new plant. Your device storage might be full."})}r(i),N(null)};return(0,a.jsxs)("div",{className:"p-4 space-y-6 bg-background",children:[(0,a.jsxs)("header",{className:"flex flex-col items-center space-y-2",children:[(0,a.jsx)("h1",{className:"font-headline text-3xl text-chart-2 font-bold",children:"Plenty Of Plants"}),(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)(s.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)(h(),{href:"/settings",children:[(0,a.jsx)(o,{className:"mr-2 h-4 w-4"}),"Settings"]})}),(0,a.jsx)(s.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)(h(),{href:"/profile",children:[(0,a.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Profile"]})})]})]}),(0,a.jsxs)("main",{className:"space-y-6",children:[(0,a.jsxs)(i.Zp,{className:"shadow-sm",children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{className:"text-xl font-semibold text-center",children:"Your Latest Collection"})}),(0,a.jsx)(i.Wu,{className:"flex flex-col items-center justify-center text-center min-h-[260px]",children:t?(0,a.jsxs)(h(),{href:"/room",className:"flex flex-col items-center gap-4 transition-transform hover:scale-105",children:[(0,a.jsx)("div",{className:"w-48 h-48 rounded-lg overflow-hidden border-2 border-primary/30 shadow-md",children:"placeholder"!==t.image?(0,a.jsx)(f.default,{src:t.image,alt:t.name,width:192,height:192,className:"object-cover w-full h-full","data-ai-hint":t.hint}):(0,a.jsx)("div",{className:"w-full h-full bg-muted flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"w-16 h-16 text-muted-foreground"})})}),(0,a.jsx)("h3",{className:"text-xl font-headline text-primary",children:t.name})]}):(0,a.jsx)("p",{className:"text-muted-foreground",children:"No plants collected yet. Time to draw one!"})})]}),(0,a.jsxs)(i.Zp,{className:"shadow-sm",children:[(0,a.jsx)(i.aR,{className:"items-center",children:(0,a.jsx)(i.ZB,{className:"text-xl font-semibold",children:"Free Draws Available"})}),(0,a.jsxs)(i.Wu,{className:"flex flex-col items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full bg-chart-3",children:(0,a.jsx)(d,{className:"h-8 w-8 text-white"})}),(0,a.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full bg-muted",children:(0,a.jsx)(u.A,{className:"h-8 w-8 text-destructive"})})]}),(0,a.jsx)(s.$,{onClick:q,disabled:n,size:"lg",className:"w-full font-semibold rounded-full mt-2",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Drawing..."]}):"Draw New Plant"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"New draw available every 12 hours (max 2 slots)."})]})]})]}),(0,a.jsx)(A,{plant:w,open:!!w,onOpenChange:e=>{e||P()}})]})}},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81202:(e,t,r)=>{Promise.resolve().then(r.bind(r,97551))},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},88526:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});var a=r(6475);let s=(0,a.createServerReference)("007c3e545aff6f125174734bb934867686df960b4e",a.callServer,void 0,a.findSourceMapURL,"drawPlant")},89708:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var a=r(65239),s=r(48088),i=r(88170),n=r.n(i),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["(app)",{children:["home",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,97551)),"/home/user/studio/src/app/(app)/home/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,70718)),"/home/user/studio/src/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/home/user/studio/src/app/(app)/home/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/(app)/home/page",pathname:"/home",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},97551:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/(app)/home/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/(app)/home/page.tsx","default")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,611,567,730,637,251],()=>r(89708));module.exports=a})();