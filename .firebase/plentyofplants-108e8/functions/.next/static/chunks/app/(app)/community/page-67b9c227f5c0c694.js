(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[861],{1169:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},1847:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(2115);let r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&a.indexOf(e)===t).join(" ")};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:h,...m}=e;return(0,s.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:a,strokeWidth:o?24*Number(i)/Number(n):i,className:r("lucide",d),...m},[...h.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),i=(e,t)=>{let a=(0,s.forwardRef)((a,l)=>{let{className:i,...o}=a;return(0,s.createElement)(n,{ref:l,iconNode:t,className:r("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...o})});return a.displayName="".concat(e),a}},2739:(e,t,a)=>{"use strict";a.d(t,{By:()=>h,Gz:()=>m,JD:()=>c,LH:()=>o,XU:()=>x,dt:()=>n,hJ:()=>i,oe:()=>u,yn:()=>p});var s=a(9708),r=a(4585),l=a(9285);let n={dailyLogin:{id:"dailyLogin",title:"Daily Login",description:"Log in each day to claim a bonus!",target:1,reward:20},collectPlants:{id:"collectPlants",title:"Plant Collector",description:"Collect 3 new plants.",target:3,reward:5},waterPlants:{id:"waterPlants",title:"Green Thumb",description:"Water your plants 5 times.",target:5,reward:5},evolvePlant:{id:"evolvePlant",title:"Evolutionist",description:"Evolve 1 of your plants.",target:1,reward:10}},i={waterEvolved:{id:"waterEvolved",title:"Advanced Care",description:"Water 5 evolved plants.",target:5,reward:15},collectMorePlants:{id:"collectMorePlants",title:"Master Collector",description:"Add 2 more plants to your collection.",target:2,reward:15},likePlayer:{id:"likePlayer",title:"Community Spirit",description:"Like another player's collection.",target:1,reward:20},applySheen:{id:"applySheen",title:"Shine On",description:"Apply a sheen pack to a plant.",target:1,reward:25}};async function o(e){let t=await (0,l.Uc)(e);if(!t)return;let a=Date.now();if(a-(t.challengesStartDate||0)>864e5){let t=(0,s.H9)(r.db,"users",e);await (0,s.mZ)(t,{challenges:{},challengesStartDate:a})}}async function d(e,t){var a;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=(0,s.H9)(r.db,"users",e),c=await (0,l.Uc)(e);if(!c||Date.now()-(c.challengesStartDate||0)>864e5)return;let h={...n,...i}[t];if(!h)return;let m=null==(a=c.challenges)?void 0:a[t];m&&(m.claimed||m.progress>=h.target)||await (0,s.mZ)(d,{["challenges.".concat(t,".progress")]:(0,s.GV)(o)})}let c=e=>{d(e,"collectPlants"),d(e,"collectMorePlants")},h=e=>d(e,"likePlayer"),m=e=>d(e,"applyGlitter"),u=e=>d(e,"applySheen"),p=async e=>{var t;let a=await (0,l.Uc)(e);if(!a)return;let n=null==(t=a.challenges)?void 0:t.dailyLogin;if(!n||n.progress<1){let t=(0,s.H9)(r.db,"users",e);await (0,s.mZ)(t,{"challenges.dailyLogin.progress":1})}};async function x(e,t){var a;let o=(0,s.H9)(r.db,"users",e),d=await (0,l.Uc)(e);if(!d)throw Error("User data not found.");let c={...n,...i}[t],h=null==(a=d.challenges)?void 0:a[t];if(!c||!h)throw Error("Challenge not found.");if(h.claimed)throw Error("Reward already claimed.");if(h.progress<c.target)throw Error("Challenge not yet complete.");await (0,s.mZ)(o,{gold:(0,s.GV)(c.reward),["challenges.".concat(t,".claimed")]:!0})}},5229:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5299:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5429:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var s=a(5155),r=a(6948),l=a(5740),n=a(1503),i=a(1847);let o=(0,i.A)("Trees",[["path",{d:"M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z",key:"1l6gj6"}],["path",{d:"M7 16v6",key:"1a82de"}],["path",{d:"M13 19v3",key:"13sx9i"}],["path",{d:"M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5",key:"1sj9kv"}]]);var d=a(5299),c=a(7801),h=a(1169),m=a(8055);let u=(0,i.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var p=a(2115),x=a(5239),f=a(9285),g=a(5894),y=a(5897),v=a(3998),j=a(4901),w=a(9689),N=a(4269),k=a(2739),b=a(1834),A=a(2619),M=a.n(A),C=a(9708),S=a(4585);function L(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden rounded-lg",children:(0,s.jsx)("div",{className:"absolute -top-1/2 w-1/12 h-[200%] bg-white/30 animate-sheen"})})}function P(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:10}).map((e,t)=>(0,s.jsx)(l.A,{className:"absolute animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),color:"hsl(".concat(360*Math.random(),", 100%, 70%)"),width:"".concat(5+5*Math.random(),"px"),height:"".concat(5+5*Math.random(),"px")}},t))})}function E(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:7}).map((e,t)=>(0,s.jsx)(l.A,{className:"absolute text-red-500 animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),width:"".concat(8+8*Math.random(),"px"),height:"".concat(8+8*Math.random(),"px")}},t))})}function G(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:7}).map((e,t)=>(0,s.jsx)(l.A,{className:"absolute text-yellow-300 animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),width:"".concat(5+5*Math.random(),"px"),height:"".concat(5+5*Math.random(),"px")}},t))})}function R(e){let{plant:t,open:a,onOpenChange:r}=e;return t?(0,s.jsx)(b.lG,{open:a,onOpenChange:r,children:(0,s.jsxs)(b.Cf,{className:"max-w-sm",children:[(0,s.jsx)(b.c7,{children:(0,s.jsx)(b.L3,{className:"text-3xl text-center text-primary",children:t.name})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 pt-4",children:[(0,s.jsxs)("div",{className:"w-64 h-64 relative",children:[(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border-4 border-primary/50 shadow-lg bg-green-100 flex items-center justify-center h-full",children:t.image&&"placeholder"!==t.image?(0,s.jsx)(x.default,{src:t.image,alt:t.name,width:256,height:256,className:"object-cover w-full h-full","data-ai-hint":t.hint}):(0,s.jsx)(n.A,{className:"w-24 h-24 text-muted-foreground/50"})}),t.hasGlitter&&(0,s.jsx)(G,{}),t.hasRedGlitter&&(0,s.jsx)(E,{}),t.hasSheen&&(0,s.jsx)(L,{}),t.hasRainbowGlitter&&(0,s.jsx)(P,{})]}),(0,s.jsx)("p",{className:"text-muted-foreground text-center mt-2 px-4",children:t.description})]}),(0,s.jsx)(b.Es,{className:"pt-2",children:(0,s.jsx)(b.HM,{asChild:!0,children:(0,s.jsx)(v.$,{className:"w-full",children:"Close"})})})]})}):null}function Z(e){let{plant:t,onSelectPlant:a}=e;return(0,s.jsxs)("div",{className:"w-full aspect-square relative rounded-md overflow-hidden bg-muted/30 border border-primary/10 cursor-pointer",onClick:()=>a(t),children:["placeholder"!==t.image?(0,s.jsx)(x.default,{src:t.image,alt:t.name,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(n.A,{className:"w-8 h-8 text-muted-foreground/40"})}),t.hasGlitter&&(0,s.jsx)(G,{}),t.hasRedGlitter&&(0,s.jsx)(E,{}),t.hasSheen&&(0,s.jsx)(L,{}),t.hasRainbowGlitter&&(0,s.jsx)(P,{}),"Evolved"===t.form&&(0,s.jsx)("div",{className:"absolute top-1 right-1 bg-secondary/80 text-secondary-foreground p-1 rounded-full shadow-md backdrop-blur-sm",children:(0,s.jsx)(l.A,{className:"w-2 h-2"})})]})}function H(){let{user:e,gameData:t}=(0,j.A)(),{playSfx:a}=(0,w.n)(),[l,n]=(0,p.useState)([]),[i,x]=(0,p.useState)(0),[b,A]=(0,p.useState)(!0),[L,P]=(0,p.useState)(!1),[E,G]=(0,p.useState)(null),{toast:H}=(0,g.dj)();(0,p.useEffect)(()=>{A(!0),P(!1);let e=(0,C.rJ)(S.db,"users"),t=(0,C.aQ)(e,e=>{let t=[];e.forEach(e=>{let a=e.data(),s=a.plants||{},r=(a.showcasePlantIds||[]).map(e=>s[e]).filter(Boolean);t.push({uid:e.id,username:a.username||"Anonymous",avatarColor:a.avatarColor||"hsl(120, 70%, 85%)",showcasePlants:r,likes:a.likes||0,gold:a.gold||0})}),t.sort((e,t)=>t.likes-e.likes),n(t),x(t.reduce((e,t)=>e+(t.gold||0),0)),A(!1)},e=>{console.error("Firestore Snapshot Error:",e),"permission-denied"===e.code?P(!0):H({variant:"destructive",title:"Failed to load community data",description:"Please try again later."}),A(!1)});return()=>t()},[H]);let B=async t=>{if(e)try{await (0,f.VI)(e.uid,t.uid),await (0,k.By)(e.uid),a("chime"),H({title:"Liked!",description:"You gave ".concat(t.username," 5 gold!")}),n(e=>e.map(e=>e.uid===t.uid?{...e,likes:e.likes+1,gold:(e.gold||0)+5}:e).sort((e,t)=>t.likes-e.likes)),x(e=>e+5)}catch(e){console.error("Failed to like user",e),e.message&&H({variant:"destructive",title:"Like Error",description:e.message})}},D=e=>{G(e),a("tap")};return(0,s.jsxs)("div",{className:"p-4 space-y-6",children:[(0,s.jsxs)("header",{className:"flex flex-col items-center gap-1 pb-4 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl text-primary",children:"Community Showcase"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"See what other players are growing! Like their showcase to give them 5 gold."}),(0,s.jsx)(v.$,{asChild:!0,variant:"secondary",className:"mt-2",children:(0,s.jsxs)(M(),{href:"/community/park",children:[(0,s.jsx)(o,{className:"mr-2 h-4 w-4"}),"Visit the Park"]})})]}),b?(0,s.jsx)("div",{className:"flex justify-center pt-10",children:(0,s.jsx)(d.A,{className:"h-10 w-10 animate-spin text-primary"})}):L?(0,s.jsxs)(r.Zp,{className:"text-center py-10 border-destructive",children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)("div",{className:"mx-auto bg-destructive/10 rounded-full w-fit p-3 mb-2",children:(0,s.jsx)(c.A,{className:"h-10 w-10 text-destructive"})}),(0,s.jsx)(r.ZB,{className:"text-destructive",children:"Permissions Error"}),(0,s.jsx)(r.BT,{children:"Your Firestore security rules are preventing you from viewing community data."})]}),(0,s.jsxs)(r.Wu,{className:"text-sm text-muted-foreground space-y-2",children:[(0,s.jsx)("p",{children:"To fix this, update your Firestore rules to allow authenticated users to read the `users` collection."}),(0,s.jsx)("p",{children:"See the updated instructions in the `DOCUMENTATION.md` file."})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.Zp,{children:[(0,s.jsx)(r.aR,{children:(0,s.jsx)(r.ZB,{className:"text-lg",children:"Game World Stats"})}),(0,s.jsxs)(r.Wu,{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"text-muted-foreground"}),(0,s.jsx)("span",{className:"font-bold",children:l.length}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Players"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.A,{className:"text-yellow-500"}),(0,s.jsx)("span",{className:"font-bold",children:i}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total Gold"})]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:l.length>0?l.map(a=>{var l;let n=null==t||null==(l=t.likedUsers)?void 0:l[a.uid],i=!n||Date.now()-n>864e5,o=!!n,d=(null==e?void 0:e.uid)===a.uid;return(0,s.jsxs)(r.Zp,{className:"shadow-md",children:[(0,s.jsxs)(r.aR,{className:"flex flex-row items-start gap-3 space-y-0",children:[(0,s.jsx)(y.eu,{className:"h-12 w-12",children:(0,s.jsx)(y.q5,{style:{backgroundColor:a.avatarColor},className:"text-xl font-bold text-primary/70",children:a.username.charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)(r.ZB,{className:"text-xl",children:a.username}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(u,{className:(0,N.cn)("w-4 h-4",a.likes>0?"text-red-500 fill-current":"")}),(0,s.jsx)("span",{className:"text-sm font-medium",children:a.likes})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(m.A,{className:"w-4 h-4 text-yellow-500"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:a.gold})]})]})]}),(0,s.jsx)(v.$,{size:"icon",variant:"outline",onClick:()=>B(a),disabled:!i||d,className:(0,N.cn)(o&&!i&&"border-red-500 text-red-500"),children:(0,s.jsx)(u,{className:(0,N.cn)("w-5 h-5",o&&!i&&"fill-current")})})]}),(0,s.jsx)(r.Wu,{children:a.showcasePlants.length>0?(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:a.showcasePlants.map(e=>(0,s.jsx)(Z,{plant:e,onSelectPlant:D},e.id))}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"This user hasn't selected a showcase yet."})})]},a.uid)}):(0,s.jsxs)(r.Zp,{className:"text-center py-10",children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)(r.ZB,{children:"The Community is Growing!"}),(0,s.jsx)(r.BT,{children:"No other players found. Be the first to get your friends to join!"})]}),(0,s.jsx)(r.Wu,{children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Go to your Profile page to select your showcase plants."})})]})})]}),(0,s.jsx)(R,{plant:E,open:!!E,onOpenChange:e=>!e&&void G(null)})]})}},5740:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},5897:(e,t,a)=>{"use strict";a.d(t,{BK:()=>o,eu:()=>i,q5:()=>d});var s=a(5155),r=a(2115),l=a(7870),n=a(4269);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});i.displayName=l.bL.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",a),...r})});o.displayName=l._V.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});d.displayName=l.H4.displayName},7481:(e,t,a)=>{Promise.resolve().then(a.bind(a,5429))},7801:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},7870:(e,t,a)=>{"use strict";a.d(t,{H4:()=>w,_V:()=>j,bL:()=>v});var s=a(2115),r=a(3468),l=a(222),n=a(4129),i=a(8142),o=a(5155),d="Avatar",[c,h]=(0,r.A)(d),[m,u]=c(d),p=s.forwardRef((e,t)=>{let{__scopeAvatar:a,...r}=e,[l,n]=s.useState("idle");return(0,o.jsx)(m,{scope:a,imageLoadingStatus:l,onImageLoadingStatusChange:n,children:(0,o.jsx)(i.sG.span,{...r,ref:t})})});p.displayName=d;var x="AvatarImage",f=s.forwardRef((e,t)=>{let{__scopeAvatar:a,src:r,onLoadingStatusChange:d=()=>{},...c}=e,h=u(x,a),m=function(e,t){let[a,r]=s.useState("idle");return(0,n.N)(()=>{if(!e)return void r("error");let a=!0,s=new window.Image,l=e=>()=>{a&&r(e)};return r("loading"),s.onload=l("loaded"),s.onerror=l("error"),s.src=e,t&&(s.referrerPolicy=t),()=>{a=!1}},[e,t]),a}(r,c.referrerPolicy),p=(0,l.c)(e=>{d(e),h.onImageLoadingStatusChange(e)});return(0,n.N)(()=>{"idle"!==m&&p(m)},[m,p]),"loaded"===m?(0,o.jsx)(i.sG.img,{...c,ref:t,src:r}):null});f.displayName=x;var g="AvatarFallback",y=s.forwardRef((e,t)=>{let{__scopeAvatar:a,delayMs:r,...l}=e,n=u(g,a),[d,c]=s.useState(void 0===r);return s.useEffect(()=>{if(void 0!==r){let e=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(e)}},[r]),d&&"loaded"!==n.imageLoadingStatus?(0,o.jsx)(i.sG.span,{...l,ref:t}):null});y.displayName=g;var v=p,j=f,w=y},8055:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]])}},e=>{e.O(0,[992,416,760,7,967,619,476,667,184,482,441,255,358],()=>e(e.s=7481)),_N_E=e.O()}]);