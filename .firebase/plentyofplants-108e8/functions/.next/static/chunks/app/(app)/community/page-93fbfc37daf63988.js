(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[861],{1169:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(1847).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},1847:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var s=t(2115);let r=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&t.indexOf(e)===a).join(" ")};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,a)=>{let{color:t="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:d,className:o="",children:c,iconNode:h,...m}=e;return(0,s.createElement)("svg",{ref:a,...l,width:n,height:n,stroke:t,strokeWidth:d?24*Number(i)/Number(n):i,className:r("lucide",o),...m},[...h.map(e=>{let[a,t]=e;return(0,s.createElement)(a,t)}),...Array.isArray(c)?c:[c]])}),i=(e,a)=>{let t=(0,s.forwardRef)((t,l)=>{let{className:i,...d}=t;return(0,s.createElement)(n,{ref:l,iconNode:a,className:r("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...d})});return t.displayName="".concat(e),t}},5229:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(1847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5299:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(1847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5429:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>T});var s=t(5155),r=t(6948),l=t(5740),n=t(1503),i=t(1847);let d=(0,i.A)("Trees",[["path",{d:"M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z",key:"1l6gj6"}],["path",{d:"M7 16v6",key:"1a82de"}],["path",{d:"M13 19v3",key:"13sx9i"}],["path",{d:"M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5",key:"1sj9kv"}]]);var o=t(5299),c=t(7801),h=t(1169),m=t(8055);let u=(0,i.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var x=t(2115),p=t(5239),f=t(9285),j=t(5894),g=t(5897),y=t(3998),v=t(4901),N=t(9689),w=t(4269),k=t(2739),b=t(1834),A=t(2619),M=t.n(A),C=t(9708),S=t(4585);function L(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden rounded-lg",children:(0,s.jsx)("div",{className:"absolute -top-1/2 w-1/12 h-[200%] bg-white/30 animate-sheen"})})}function R(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:10}).map((e,a)=>(0,s.jsx)(l.A,{className:"absolute animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),color:"hsl(".concat(360*Math.random(),", 100%, 70%)"),width:"".concat(5+5*Math.random(),"px"),height:"".concat(5+5*Math.random(),"px")}},a))})}function E(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:7}).map((e,a)=>(0,s.jsx)(l.A,{className:"absolute text-red-500 animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),width:"".concat(8+8*Math.random(),"px"),height:"".concat(8+8*Math.random(),"px")}},a))})}function G(){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none z-20 overflow-hidden",children:Array.from({length:7}).map((e,a)=>(0,s.jsx)(l.A,{className:"absolute text-yellow-300 animate-sparkle",style:{top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(1.5*Math.random(),"s"),width:"".concat(5+5*Math.random(),"px"),height:"".concat(5+5*Math.random(),"px")}},a))})}function P(e){let{plant:a,open:t,onOpenChange:r}=e;return a?(0,s.jsx)(b.lG,{open:t,onOpenChange:r,children:(0,s.jsxs)(b.Cf,{className:"max-w-sm",children:[(0,s.jsx)(b.c7,{children:(0,s.jsx)(b.L3,{className:"text-3xl text-center text-primary",children:a.name})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 pt-4",children:[(0,s.jsxs)("div",{className:"w-64 h-64 relative",children:[(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border-4 border-primary/50 shadow-lg bg-green-100 flex items-center justify-center h-full",children:a.image&&"placeholder"!==a.image?(0,s.jsx)(p.default,{src:a.image,alt:a.name,width:256,height:256,className:"object-cover w-full h-full","data-ai-hint":a.hint}):(0,s.jsx)(n.A,{className:"w-24 h-24 text-muted-foreground/50"})}),a.hasGlitter&&(0,s.jsx)(G,{}),a.hasRedGlitter&&(0,s.jsx)(E,{}),a.hasSheen&&(0,s.jsx)(L,{}),a.hasRainbowGlitter&&(0,s.jsx)(R,{})]}),(0,s.jsx)("p",{className:"text-muted-foreground text-center mt-2 px-4",children:a.description})]}),(0,s.jsx)(b.Es,{className:"pt-2",children:(0,s.jsx)(b.HM,{asChild:!0,children:(0,s.jsx)(y.$,{className:"w-full",children:"Close"})})})]})}):null}function B(e){let{plant:a,onSelectPlant:t}=e;return(0,s.jsxs)("div",{className:"w-full aspect-square relative rounded-md overflow-hidden bg-muted/30 border border-primary/10 cursor-pointer",onClick:()=>t(a),children:["placeholder"!==a.image?(0,s.jsx)(p.default,{src:a.image,alt:a.name,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(n.A,{className:"w-8 h-8 text-muted-foreground/40"})}),a.hasGlitter&&(0,s.jsx)(G,{}),a.hasRedGlitter&&(0,s.jsx)(E,{}),a.hasSheen&&(0,s.jsx)(L,{}),a.hasRainbowGlitter&&(0,s.jsx)(R,{}),"Evolved"===a.form&&(0,s.jsx)("div",{className:"absolute top-1 right-1 bg-secondary/80 text-secondary-foreground p-1 rounded-full shadow-md backdrop-blur-sm",children:(0,s.jsx)(l.A,{className:"w-2 h-2"})})]})}function T(){let{user:e,gameData:a}=(0,v.A)(),{playSfx:t}=(0,N.n)(),[l,n]=(0,x.useState)([]),[i,p]=(0,x.useState)(0),[b,A]=(0,x.useState)(!0),[L,R]=(0,x.useState)(!1),[E,G]=(0,x.useState)(null),{toast:T}=(0,j.dj)();(0,x.useEffect)(()=>{A(!0),R(!1);let e=(0,C.rJ)(S.db,"users"),a=(0,C.aQ)(e,e=>{let a=[];e.forEach(e=>{let t=e.data(),s=t.plants||{},r=(t.showcasePlantIds||[]).map(e=>s[e]).filter(Boolean);a.push({uid:e.id,username:t.username||"Anonymous",avatarColor:t.avatarColor||"hsl(120, 70%, 85%)",showcasePlants:r,likes:t.likes||0,gold:t.gold||0})}),a.sort((e,a)=>a.likes-e.likes),n(a),p(a.reduce((e,a)=>e+(a.gold||0),0)),A(!1)},e=>{console.error("Firestore Snapshot Error:",e),"permission-denied"===e.code?R(!0):T({variant:"destructive",title:"Failed to load community data",description:"Please try again later."}),A(!1)});return()=>a()},[T]);let Z=async a=>{if(e)try{await (0,f.VI)(e.uid,a.uid),await (0,k.By)(e.uid),t("chime"),T({title:"Liked!",description:"You gave ".concat(a.username," 5 gold!")}),n(e=>e.map(e=>e.uid===a.uid?{...e,likes:e.likes+1,gold:(e.gold||0)+5}:e).sort((e,a)=>a.likes-e.likes)),p(e=>e+5)}catch(e){console.error("Failed to like user",e),e.message&&T({variant:"destructive",title:"Like Error",description:e.message})}},z=e=>{G(e),t("tap")};return(0,s.jsxs)("div",{className:"p-4 space-y-6",children:[(0,s.jsxs)("header",{className:"flex flex-col items-center gap-1 pb-4 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl text-primary",children:"Community Showcase"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"See what other players are growing! Like their showcase to give them 5 gold."}),(0,s.jsx)(y.$,{asChild:!0,variant:"secondary",className:"mt-2",children:(0,s.jsxs)(M(),{href:"/community/park",children:[(0,s.jsx)(d,{className:"mr-2 h-4 w-4"}),"Visit the Park"]})})]}),b?(0,s.jsx)("div",{className:"flex justify-center pt-10",children:(0,s.jsx)(o.A,{className:"h-10 w-10 animate-spin text-primary"})}):L?(0,s.jsxs)(r.Zp,{className:"text-center py-10 border-destructive",children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)("div",{className:"mx-auto bg-destructive/10 rounded-full w-fit p-3 mb-2",children:(0,s.jsx)(c.A,{className:"h-10 w-10 text-destructive"})}),(0,s.jsx)(r.ZB,{className:"text-destructive",children:"Permissions Error"}),(0,s.jsx)(r.BT,{children:"Your Firestore security rules are preventing you from viewing community data."})]}),(0,s.jsxs)(r.Wu,{className:"text-sm text-muted-foreground space-y-2",children:[(0,s.jsx)("p",{children:"To fix this, update your Firestore rules to allow authenticated users to read the `users` collection."}),(0,s.jsx)("p",{children:"See the updated instructions in the `DOCUMENTATION.md` file."})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.Zp,{children:[(0,s.jsx)(r.aR,{children:(0,s.jsx)(r.ZB,{className:"text-lg",children:"Game World Stats"})}),(0,s.jsxs)(r.Wu,{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"text-muted-foreground"}),(0,s.jsx)("span",{className:"font-bold",children:l.length}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Players"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.A,{className:"text-yellow-500"}),(0,s.jsx)("span",{className:"font-bold",children:i}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total Gold"})]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:l.length>0?l.map(t=>{var l;let n=null==a||null==(l=a.likedUsers)?void 0:l[t.uid],i=!n||Date.now()-n>864e5,d=!!n,o=(null==e?void 0:e.uid)===t.uid;return(0,s.jsxs)(r.Zp,{className:"shadow-md",children:[(0,s.jsxs)(r.aR,{className:"flex flex-row items-start gap-3 space-y-0",children:[(0,s.jsx)(g.eu,{className:"h-12 w-12",children:(0,s.jsx)(g.q5,{style:{backgroundColor:t.avatarColor},className:"text-xl font-bold text-primary/70",children:t.username.charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)(r.ZB,{className:"text-xl",children:t.username}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(u,{className:(0,w.cn)("w-4 h-4",t.likes>0?"text-red-500 fill-current":"")}),(0,s.jsx)("span",{className:"text-sm font-medium",children:t.likes})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(m.A,{className:"w-4 h-4 text-yellow-500"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:t.gold})]})]})]}),(0,s.jsx)(y.$,{size:"icon",variant:"outline",onClick:()=>Z(t),disabled:!i||o,className:(0,w.cn)(d&&!i&&"border-red-500 text-red-500"),children:(0,s.jsx)(u,{className:(0,w.cn)("w-5 h-5",d&&!i&&"fill-current")})})]}),(0,s.jsx)(r.Wu,{children:t.showcasePlants.length>0?(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:t.showcasePlants.map(e=>(0,s.jsx)(B,{plant:e,onSelectPlant:z},e.id))}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"This user hasn't selected a showcase yet."})})]},t.uid)}):(0,s.jsxs)(r.Zp,{className:"text-center py-10",children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)(r.ZB,{children:"The Community is Growing!"}),(0,s.jsx)(r.BT,{children:"No other players found. Be the first to get your friends to join!"})]}),(0,s.jsx)(r.Wu,{children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Go to your Profile page to select your showcase plants."})})]})})]}),(0,s.jsx)(P,{plant:E,open:!!E,onOpenChange:e=>!e&&void G(null)})]})}},5740:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(1847).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},5897:(e,a,t)=>{"use strict";t.d(a,{BK:()=>d,eu:()=>i,q5:()=>o});var s=t(5155),r=t(2115),l=t(7870),n=t(4269);let i=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l.bL,{ref:a,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});i.displayName=l.bL.displayName;let d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l._V,{ref:a,className:(0,n.cn)("aspect-square h-full w-full",t),...r})});d.displayName=l._V.displayName;let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l.H4,{ref:a,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});o.displayName=l.H4.displayName},7481:(e,a,t)=>{Promise.resolve().then(t.bind(t,5429))},7801:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(1847).A)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},7870:(e,a,t)=>{"use strict";t.d(a,{H4:()=>N,_V:()=>v,bL:()=>y});var s=t(2115),r=t(3468),l=t(222),n=t(4129),i=t(8142),d=t(5155),o="Avatar",[c,h]=(0,r.A)(o),[m,u]=c(o),x=s.forwardRef((e,a)=>{let{__scopeAvatar:t,...r}=e,[l,n]=s.useState("idle");return(0,d.jsx)(m,{scope:t,imageLoadingStatus:l,onImageLoadingStatusChange:n,children:(0,d.jsx)(i.sG.span,{...r,ref:a})})});x.displayName=o;var p="AvatarImage",f=s.forwardRef((e,a)=>{let{__scopeAvatar:t,src:r,onLoadingStatusChange:o=()=>{},...c}=e,h=u(p,t),m=function(e,a){let[t,r]=s.useState("idle");return(0,n.N)(()=>{if(!e)return void r("error");let t=!0,s=new window.Image,l=e=>()=>{t&&r(e)};return r("loading"),s.onload=l("loaded"),s.onerror=l("error"),s.src=e,a&&(s.referrerPolicy=a),()=>{t=!1}},[e,a]),t}(r,c.referrerPolicy),x=(0,l.c)(e=>{o(e),h.onImageLoadingStatusChange(e)});return(0,n.N)(()=>{"idle"!==m&&x(m)},[m,x]),"loaded"===m?(0,d.jsx)(i.sG.img,{...c,ref:a,src:r}):null});f.displayName=p;var j="AvatarFallback",g=s.forwardRef((e,a)=>{let{__scopeAvatar:t,delayMs:r,...l}=e,n=u(j,t),[o,c]=s.useState(void 0===r);return s.useEffect(()=>{if(void 0!==r){let e=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(e)}},[r]),o&&"loaded"!==n.imageLoadingStatus?(0,d.jsx)(i.sG.span,{...l,ref:a}):null});g.displayName=j;var y=x,v=f,N=g},8055:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(1847).A)("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]])}},e=>{e.O(0,[992,416,909,382,619,39,476,667,560,35,441,255,358],()=>e(e.s=7481)),_N_E=e.O()}]);